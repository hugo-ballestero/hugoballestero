<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Andrea Moncanut , Hugo Ballestero , Xiker Martín">

<title>Entrega grupal</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="entrega-grupal_files/libs/clipboard/clipboard.min.js"></script>
<script src="entrega-grupal_files/libs/quarto-html/quarto.js"></script>
<script src="entrega-grupal_files/libs/quarto-html/popper.min.js"></script>
<script src="entrega-grupal_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="entrega-grupal_files/libs/quarto-html/anchor.min.js"></script>
<link href="entrega-grupal_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="entrega-grupal_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="entrega-grupal_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="entrega-grupal_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="entrega-grupal_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="entrega-grupal_files/libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="entrega-grupal_files/libs/plotly-binding-4.10.3/plotly.js"></script>
<script src="entrega-grupal_files/libs/typedarray-0.1/typedarray.min.js"></script>
<script src="entrega-grupal_files/libs/jquery-3.5.1/jquery.min.js"></script>
<link href="entrega-grupal_files/libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="entrega-grupal_files/libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="entrega-grupal_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="entrega-grupal_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Índice</h2>
   
  <ul>
  <li><a href="#instrucciones-leer-antes-de-empezar" id="toc-instrucciones-leer-antes-de-empezar" class="nav-link active" data-scroll-target="#instrucciones-leer-antes-de-empezar">Instrucciones (leer antes de empezar)</a>
  <ul class="collapse">
  <li><a href="#paquetes-necesarios" id="toc-paquetes-necesarios" class="nav-link" data-scroll-target="#paquetes-necesarios">Paquetes necesarios</a></li>
  </ul></li>
  <li><a href="#práctica-grupal" id="toc-práctica-grupal" class="nav-link" data-scroll-target="#práctica-grupal">Práctica grupal</a>
  <ul class="collapse">
  <li><a href="#datos" id="toc-datos" class="nav-link" data-scroll-target="#datos">Datos</a></li>
  <li><a href="#objetivos-e-ítems-obligatorios" id="toc-objetivos-e-ítems-obligatorios" class="nav-link" data-scroll-target="#objetivos-e-ítems-obligatorios">Objetivos e ítems obligatorios</a></li>
  </ul></li>
  <li><a href="#código" id="toc-código" class="nav-link" data-scroll-target="#código">CÓDIGO</a>
  <ul class="collapse">
  <li><a href="#tidy-data" id="toc-tidy-data" class="nav-link" data-scroll-target="#tidy-data">1. Tidy data</a>
  <ul class="collapse">
  <li><a href="#modificamos-la-data-siglas" id="toc-modificamos-la-data-siglas" class="nav-link" data-scroll-target="#modificamos-la-data-siglas"><strong>1. MODIFICAMOS LA DATA SIGLAS</strong></a></li>
  <li><a href="#limpiar-datos-electorales" id="toc-limpiar-datos-electorales" class="nav-link" data-scroll-target="#limpiar-datos-electorales">2. LIMPIAR DATOS ELECTORALES</a></li>
  <li><a href="#limpiar-encuestas" id="toc-limpiar-encuestas" class="nav-link" data-scroll-target="#limpiar-encuestas">3. LIMPIAR ENCUESTAS</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#trabajando-con-las-bases" id="toc-trabajando-con-las-bases" class="nav-link" data-scroll-target="#trabajando-con-las-bases">2. Trabajando con las bases</a>
  <ul class="collapse">
  <li><a href="#tema-para-los-gráficos" id="toc-tema-para-los-gráficos" class="nav-link" data-scroll-target="#tema-para-los-gráficos">Tema para los gráficos</a></li>
  <li><a href="#ejercicio-1" id="toc-ejercicio-1" class="nav-link" data-scroll-target="#ejercicio-1">EJERCICIO 1</a></li>
  <li><a href="#ejercicio-2" id="toc-ejercicio-2" class="nav-link" data-scroll-target="#ejercicio-2">EJERCICIO 2</a></li>
  <li><a href="#ejercicio-3" id="toc-ejercicio-3" class="nav-link" data-scroll-target="#ejercicio-3">EJERCICIO 3</a></li>
  <li><a href="#ejercicio-4" id="toc-ejercicio-4" class="nav-link" data-scroll-target="#ejercicio-4">EJERCICIO 4</a></li>
  <li><a href="#ejercicio-5" id="toc-ejercicio-5" class="nav-link" data-scroll-target="#ejercicio-5">EJERCICIO 5</a></li>
  <li><a href="#ejercicio-6" id="toc-ejercicio-6" class="nav-link" data-scroll-target="#ejercicio-6">EJERCICIO 6</a></li>
  <li><a href="#ejercicio-7" id="toc-ejercicio-7" class="nav-link" data-scroll-target="#ejercicio-7">EJERCICIO 7</a></li>
  <li><a href="#ejercicio-8" id="toc-ejercicio-8" class="nav-link" data-scroll-target="#ejercicio-8">EJERCICIO 8</a>
  <ul class="collapse">
  <li><a href="#en-general-para-lo-demás" id="toc-en-general-para-lo-demás" class="nav-link" data-scroll-target="#en-general-para-lo-demás">EN GENERAL PARA LO DEMÁS</a></li>
  <li><a href="#código-para-casas-encuestadoras-y-partidos" id="toc-código-para-casas-encuestadoras-y-partidos" class="nav-link" data-scroll-target="#código-para-casas-encuestadoras-y-partidos">CÓDIGO PARA CASAS ENCUESTADORAS Y PARTIDOS</a></li>
  <li><a href="#código-por-partidos" id="toc-código-por-partidos" class="nav-link" data-scroll-target="#código-por-partidos">CÓDIGO POR PARTIDOS</a></li>
  </ul></li>
  <li><a href="#ejercicio-9" id="toc-ejercicio-9" class="nav-link" data-scroll-target="#ejercicio-9">EJERCICIO 9</a></li>
  <li><a href="#ejercicio-10" id="toc-ejercicio-10" class="nav-link" data-scroll-target="#ejercicio-10">EJERCICIO 10</a></li>
  <li><a href="#ejercicio-11" id="toc-ejercicio-11" class="nav-link" data-scroll-target="#ejercicio-11">EJERCICIO 11</a></li>
  <li><a href="#nuestros-resultados" id="toc-nuestros-resultados" class="nav-link" data-scroll-target="#nuestros-resultados">3. NUESTROS RESULTADOS</a></li>
  <li><a href="#ejercicio-12" id="toc-ejercicio-12" class="nav-link" data-scroll-target="#ejercicio-12">EJERCICIO 12</a></li>
  <li><a href="#ejercicio-13" id="toc-ejercicio-13" class="nav-link" data-scroll-target="#ejercicio-13">EJERCICIO 13</a></li>
  <li><a href="#ejercicio-14" id="toc-ejercicio-14" class="nav-link" data-scroll-target="#ejercicio-14">EJERCICIO 14</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Entrega grupal</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Andrea Moncanut , Hugo Ballestero , Xiker Martín </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="instrucciones-leer-antes-de-empezar" class="level2">
<h2 class="anchored" data-anchor-id="instrucciones-leer-antes-de-empezar">Instrucciones (leer antes de empezar)</h2>
<ul>
<li><p>Modificad dentro del documento <code>.qmd</code> vuestros datos personales (nombres y DNI) ubicados en la cabecera del archivo.</p></li>
<li><p>Aseguraos, <strong>ANTES de seguir editando</strong> el documento, que el archivo <code>.qmd</code> se renderiza correctamente y se genera el <code>.html</code> correspondiente en tu carpeta local de tu ordenador.</p></li>
<li><p>Los chunks (cajas de código) creados están o vacíos o incompletos. Una vez que editeis lo que consideres, debeis ir cambiando cada chunck a <code>#| eval: true</code> (o quitarlo directamente) para que se ejecuten.</p></li>
<li><p>Recordad que puedes ejecutar chunk a chunk con el botón <em>play</em> o ejecutar todos los chunk hasta uno dado (con el botón a la izquierda del anterior).</p></li>
</ul>
<section id="paquetes-necesarios" class="level3">
<h3 class="anchored" data-anchor-id="paquetes-necesarios">Paquetes necesarios</h3>
<blockquote class="blockquote">
<p>Introduce en el chunk inferior los paquetes que vayas a necesitar</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co"># Borramos variables de environment</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.3     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.3     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gganimate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'gganimate' was built under R version 4.3.2</code></pre>
</div>
</div>
</section>
</section>
<section id="práctica-grupal" class="level2">
<h2 class="anchored" data-anchor-id="práctica-grupal">Práctica grupal</h2>
<section id="datos" class="level3">
<h3 class="anchored" data-anchor-id="datos">Datos</h3>
<p>La práctica versará entorno a los <strong>archivos de datos electorales</strong> que ya hemos trabajado, recopilando datos de citas electorales al Congreso de los Diputados de España desde 2008 hasta la actualidad</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NO TOQUES NADA</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>datos_elecciones <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./datos/datos_elecciones_brutos.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: One or more parsing issues, call `problems()` on your data frame for details,
e.g.:
  dat &lt;- vroom(...)
  problems(dat)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 48737 Columns: 471
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr   (5): tipo_eleccion, mes, codigo_ccaa, codigo_provincia, codigo_municipio
dbl (424): anno, vuelta, codigo_distrito_electoral, numero_mesas, censo, par...
lgl  (42): FALANGE ESPAÑOLA DE LA JONS, PARTIDO COMUNISTA DEL PUEBLO CASTELL...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>cod_mun <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./datos/cod_mun.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 8135 Columns: 2
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (2): cod_mun, municipio

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>encuestas <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./datos/historical_surveys.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 3753 Columns: 59
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr   (4): type_survey, id_pollster, pollster, media
dbl  (51): size, turnout, UCD, PSOE, PCE, AP, CIU, PA, EAJ-PNV, HB, ERC, EE,...
lgl   (1): exit_poll
date  (3): date_elec, field_date_from, field_date_to

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>siglas <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./datos/siglas.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 587 Columns: 2
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (2): denominacion, siglas

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>Los datos serán los siguientes:</p>
<ul>
<li><p><code>datos_elecciones</code>: archivo con los datos electorales al Congreso desde 2018 hasta las últimas de 2019.</p>
<ul>
<li><code>tipo_eleccion</code>: tipo de elección (02 si es elección al congreso)</li>
<li><code>anno</code>, <code>mes</code>: año y mes de las elecciones</li>
<li><code>vuelta</code>: vuelta electoral (1 si es primera vuelta)</li>
<li><code>codigo_ccaa, codigo_provincia, codigo_municipio, codigo_distrito_electoral</code>: código de la ccaa, provincia, municipio y distrito electoral.</li>
<li><code>numero_mesas</code>: número de mesas electorales</li>
<li><code>censo</code>: censo electoral</li>
<li><code>participacion_1, participacion_2</code>: participación en el primer avance (14:00) y segundo avance (18:00) antes del cierre de urnas (20:00)</li>
<li><code>votos_blancos</code>: votos en blanco</li>
<li><code>votos_candidaturas</code>: votos a papeletas de partidos</li>
<li><code>votos_nulos</code>: votos nulos</li>
<li>votos recibidos por cada uno de los partidos</li>
</ul></li>
<li><p><code>cod_mun</code>: archivo con los códigos y nombres de cada municipio</p></li>
<li><p><code>siglas</code>: siglas y nombres asociados a cada partido</p></li>
<li><p><code>encuestas</code>: tabla de encuestas electorales desde 1982. Algunas de las variables son las siguientes:</p>
<ul>
<li><code>type_survey</code>: tipo de encuesta (nacional, autonómica, etc)</li>
<li><code>date_elec</code>: fecha de las futuras elecciones</li>
<li><code>id_pollster</code>, <code>pollster</code>, <code>media</code>: identificador y nombre de la casa encuestadora, así como el medio que lo haya encargado</li>
<li><code>field_date_from</code>, <code>field_date_to</code>: fecha de inicio y final del trabajo de campo</li>
<li><code>exit_poll</code>: si se trata de una encuesta a pie de urna o no</li>
<li><code>size</code>: tamaño muestral</li>
<li><code>turnout</code>: estimación de la participación</li>
<li>estimación de intención de voto para los principales partidos</li>
</ul></li>
</ul>
</section>
<section id="objetivos-e-ítems-obligatorios" class="level3">
<h3 class="anchored" data-anchor-id="objetivos-e-ítems-obligatorios">Objetivos e ítems obligatorios</h3>
<p>El objetivo de la entrega es realizar un análisis de los datos electorales, llevando a cabo la depuración, resúmenes y gráficos que consideres, tanto de sus resultaados como del acierto de las encuestas electorales.</p>
<p>En concreto <strong>se deberá trabajar solo en la ventana temporal que comprenden las elecciones desde 2008 hasta las últimas elecciones de 2019</strong>.</p>
<section id="indicaciones-generales" class="level4">
<h4 class="anchored" data-anchor-id="indicaciones-generales">Indicaciones generales</h4>
<p>Amén de lo que te parezca oportuno ejecutar, serán obligatorios los siguientes ítems:</p>
<ul>
<li><p>Cada grupo deberá presentar <strong>al menos 48 horas antes un análisis de los datos</strong> en formato <code>.qmd</code> y <code>.html</code> en modo <strong>diapositivas</strong>, que <strong>serán las que expongan el día de la presentación</strong>.</p></li>
<li><p>Durante la presentación se <strong>explicará el análisis realizado</strong> de manera que <strong>cada miembro del equipo habla un tiempo similar</strong> y <strong>cada miembro podrá ser preguntado por cualquiera de los pasos</strong>. La nota no tendrá porque ser la misma para todos/as los/as integrantes.</p></li>
<li><p>Se valorará no solo el contenido sino el continente (estética).</p></li>
<li><p>Se valorará positivamente que las diapositivas estén alojadas en Github.</p></li>
<li><p>El objetivo es demostrar que se adquirido el máximo de conocimientos del curso: cuantas más contenido del temario se incluya, mejor.</p></li>
</ul>
</section>
<section id="ítems-obligatorios" class="level4">
<h4 class="anchored" data-anchor-id="ítems-obligatorios">Ítems obligatorios:</h4>
<ul>
<li><p>Se deberá de <strong>convertir los datos a tidydata</strong> cuando proceda.</p></li>
<li><p>Se deberá <strong>incluir al menos un cruce (join)</strong> entre tablas.</p></li>
<li><p>Reminder: información = varianza, así que se deberán <strong>retirar columnas que no nos van a aportar nada</strong>.</p></li>
<li><p>Se deberá usar el <strong>paquete glue y lubridate</strong> en algún momento, así como el paquete <strong>forcats</strong>, <strong>ggplot2</strong> y <strong>plotly</strong></p></li>
<li><p>Se deberá usar al menos una vez lo siguiente:</p>
<ul>
<li>mutate</li>
<li>summarise</li>
<li>group_by (o equivalente)</li>
<li>case_when</li>
</ul></li>
<li><p>Tenemos muchísimos partidos que se presentan a las elecciones. Solo nos intereserán los siguientes partidos:</p>
<ul>
<li>PARTIDO SOCIALISTA OBRERO ESPAÑOL (cuidado: tiene/tuvo federaciones - sucursales - con algún otro nombre)</li>
<li>PARTIDO POPULAR</li>
<li>CIUDADANOS (cuidado: tiene/tuvo federaciones - sucursales - con algún otro nombre)</li>
<li>PARTIDO NACIONALISTA VASCO</li>
<li>BLOQUE NACIONALISTA GALEGO</li>
<li>COMPROMÍS</li>
<li>CONVERGÈNCIA I UNIÓ</li>
<li>UNIDAS PODEMOS - IU (cuidado que aquí han tenido nombres variados - IU, los verdes, podem, ezker batua, …- y no siempre han ido juntos, pero aquí los analizaremos juntos</li>
<li>ESQUERRA REPUBLICANA DE CATALUNYA</li>
<li>EH - BILDU (son ahora una coalición de partidos formados por Sortu, Eusko Alkartasuna, Aralar, Alternatiba)</li>
<li>MÁS PAÍS</li>
<li>VOX7*</li>
</ul></li>
<li><p>Todo lo que no sea alguno de los anteriores partidos deberá ser imputado como “OTROS”. Recuerda agregar los datos tras la recodificación anterior.</p></li>
<li><p>Para las visualizaciones se usarán las siglas de los partidos. El trabajo deberá contener al menos 5 gráficas, de las cuales al menos 3 deben ser tipos de gráficos distintos (ver <a href="https://r-graph-gallery.com/" class="uri">https://r-graph-gallery.com/</a>), todas ellas con un tema personalizado</p></li>
<li><p>Deberás usar los 4 archivos de datos en algún momento</p></li>
<li><p>Deberás definir al menos una función propia (que no sea trivial)</p></li>
<li><p>Deberás descartar obligatoriamente las encuestas que:</p>
<ul>
<li>hagan referencia a elecciones anteriores a 2018</li>
<li>que sean a pie de urna</li>
<li>que tenga un tamaño muestral inferior a 750 o que sea desconocido</li>
<li>que tengan menos de 1 o menos días de trabajo de campo</li>
</ul></li>
<li><p>Deberás responder obligatoriamente a las siguientes preguntas (más las que consideres analizar para distinguirte del resto de equipos, ya sea numérica y/o gráficamente, pudiendo responder con números y/o con gráficos, decidiendo la mejor visualización que consideres.)</p>
<ul>
<li>¿Cómo se reparte el voto de partidos de ámbito nacional (PSOE, PP, VOX, CS, MP, UP - IU) frente a los partidos de corte autonómico o nacionalista?</li>
<li>¿Cuál el partido ganador en los municipios de más de 100 000 habitantes de censo en cada una de las elecciones?</li>
<li>¿Qué partido fue el segundo cuando el primero fue el PSOE? ¿Y cuándo el primero fue el PP?</li>
<li>¿En qué municipios de más 2000 habitantes de censo, provincias o autonomías la diferencia entre el ganador y el segundo es más elevada?</li>
<li>¿Cuáles son los municipios con mayor porcentaje de votos nulos de España?</li>
<li>¿En qué sitios hay mayor participación? ¿Quién ganó en los sitios con mayor participación y donde menos? ¿A quién le beneficia la baja participación?</li>
<li>¿Cómo analizar la relación entre censo y voto? ¿Es cierto que ciertos partidos ganan lo rural?</li>
<li>¿Cómo calibrar el error de las encuestas? ¿Cómo visualizarlo? (recuerda que las encuestas son intención de voto a nivel nacional)</li>
<li>¿En qué elección se equivocaron más las encuestas?</li>
<li>¿Cómo se equivocaron las encuestas en partidos de ámbito nacional (PSOE, PP, VOX, CS, MP, UP - IU)</li>
<li>¿Qué casas encuestadores acertaron más y cuales se desviaron más de los resultados?</li>
</ul></li>
</ul>
</section>
<section id="calificación" class="level4">
<h4 class="anchored" data-anchor-id="calificación">Calificación</h4>
<p><strong>No se valorará más al que más cosas haga</strong>. Más no siempre es mejor. Se valorará la <strong>originalidad</strong> (respecto al resto de trabajos, por ejemplo en lo analizado o en el tema o …) de lo planteado, tanto en manejo de tablas como en visualización, el <strong>cariño</strong> puesto en la entrega (el cariño en la vida es importante) y la <strong>pertinencia</strong> de lo realizado. Una vez que tengáis los ítems obligatorios con tu base de datos más o menos completada, <strong>piensa antes</strong> de ponerte a picar código: ¿qué puede ser interesante? ¿Qué necesito para poder obtener un resumen tanto numérico tanto visual?</p>
<p>Recordad que el fin real es demostrarme un dominio de las herramientas vistas a lo largo del curso. Y eso pasa no solo por la cantidad de ellas utilizadas sino por la calidad al ejecutarlas.</p>
</section>
</section>
</section>
<section id="código" class="level1">
<h1>CÓDIGO</h1>
<section id="tidy-data" class="level2">
<h2 class="anchored" data-anchor-id="tidy-data">1. Tidy data</h2>
<section id="modificamos-la-data-siglas" class="level3">
<h3 class="anchored" data-anchor-id="modificamos-la-data-siglas"><strong>1. MODIFICAMOS LA DATA SIGLAS</strong></h3>
<p>Para la base de datos siglas, en la columna siglas, hay casos que hay mayúsculas y minúsculas mezcladas, puntos de pormedio, etc, que luego, a la hora de cruzar la tabla de las elecciones con la de siglas se reptirán aquellos partidos que tengan distintas formas de escribir su sigla. Así para evitar repeticiones normalizaremos las siglas realizando una función que trabaje esto y que luego se pueda aplicar a la data correspondiente, así como, aplicar un distinct por siglas para eliminar datos redundantes (únicamente exista un partido con dicha sigla).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>caracteres_especiales <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">unlist</span>(<span class="fu">str_extract_all</span>(siglas<span class="sc">$</span>siglas,<span class="st">"</span><span class="sc">\\</span><span class="st">W"</span>))) <span class="co">#para tener constancia de cuáles símbolos hay</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>normalizar_siglas <span class="ot">&lt;-</span> <span class="cf">function</span>(sigla) {</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  sigla_normalizada <span class="ot">&lt;-</span> sigla</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  sigla_normalizada <span class="ot">&lt;-</span> <span class="fu">toupper</span>(sigla_normalizada)  <span class="co"># Convertir a mayúsculas</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  sigla_normalizada <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">."</span>, <span class="st">""</span>, sigla_normalizada)  <span class="co"># Eliminar puntos</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  sigla_normalizada <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"-"</span>, <span class="st">""</span>, sigla_normalizada) <span class="co">#Eliminar guiones</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  sigla_normalizada <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">("</span>, <span class="st">""</span>, sigla_normalizada) <span class="co"># Elimina paréntesis abierto</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  sigla_normalizada <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">)"</span>, <span class="st">""</span>, sigla_normalizada) <span class="co"># Elimina paréntesis cerrado</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  sigla_normalizada <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">""</span>, sigla_normalizada)  <span class="co"># Eliminar espacios</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  sigla_normalizada <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">""</span>, sigla_normalizada)  <span class="co"># Eliminar comas</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  sigla_normalizada <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"'"</span>, <span class="st">""</span>, sigla_normalizada)  <span class="co"># Eliminar '</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  sigla_normalizada <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"´"</span>, <span class="st">""</span>, sigla_normalizada)  <span class="co"># Eliminar ´</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  sigla_normalizada <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">":"</span>, <span class="st">""</span>, sigla_normalizada)  <span class="co"># Eliminar :</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  sigla_normalizada <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">+"</span>, <span class="st">""</span>, sigla_normalizada)  <span class="co"># Eliminar +</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  sigla_normalizada <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"¡"</span>, <span class="st">""</span>, sigla_normalizada)  <span class="co"># Eliminar ¡</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  sigla_normalizada <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" \ "</span>, <span class="st">""</span>, sigla_normalizada) <span class="co"># Eliminar \</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  sigla_normalizada <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"/"</span>, <span class="st">""</span>, sigla_normalizada)  <span class="co"># Eliminar /</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  sigla_normalizada <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'"'</span>, <span class="st">""</span>, sigla_normalizada)  <span class="co"># Eliminar "</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sigla_normalizada)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="co"># podemos comprobar</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>respuesta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">normalizar_siglas</span>(<span class="st">'+PS,oE+'</span>), <span class="fu">normalizar_siglas</span>(<span class="st">"¡P/p"</span>))</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>respuesta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PSOE" "PP"  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>siglas<span class="sc">$</span>siglas <span class="ot">&lt;-</span> <span class="fu">sapply</span>(siglas<span class="sc">$</span>siglas, normalizar_siglas)  </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>siglas <span class="ot">&lt;-</span>  </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  siglas <span class="sc">|&gt;</span>  </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(siglas, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># para que sólo haya un nombre por siglas para el left join</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>siglas</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 505 × 2
   denominacion                                       siglas
   &lt;chr&gt;                                              &lt;chr&gt; 
 1 PARTIDO HUMANISTA                                  PH    
 2 ACCION REPUBLICANA                                 AR    
 3 PARTIDO DE LA LEY NATURAL                          PLN   
 4 EUZKO ALDERDI JELTZALEA-PARTIDO NACIONALISTA VASCO EAJPNV
 5 BERDEAK-LOS VERDES                                 BLV   
 6 LA FALANGE                                         FE    
 7 EZKER BATUA-IZQUIERDA UNIDA                        EBIU  
 8 PARTIDO OBRERO SOCIALISTA INTERNACIONALISTA        POSI  
 9 EUSKAL HERRITARROK                                 EH    
10 UNION CENTRISTA-CENTRO DEMOCRATICO Y SOCIAL        CDSUC 
# ℹ 495 more rows</code></pre>
</div>
</div>
</section>
<section id="limpiar-datos-electorales" class="level3">
<h3 class="anchored" data-anchor-id="limpiar-datos-electorales">2. LIMPIAR DATOS ELECTORALES</h3>
<p>Para ello, primero comprobaremos que las variables cogen varios valores distintos, en caso contrario, al ser constantes las eliminaremos. Después, se convertirán las columnas necesarias a filas.</p>
<p>En este caso, además, se convertirán las variables necesarias de lógicas en númericas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>datos_elecciones <span class="sc">|&gt;</span>    </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), n_distinct))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 471
  tipo_eleccion  anno   mes vuelta codigo_ccaa codigo_provincia codigo_municipio
          &lt;int&gt; &lt;int&gt; &lt;int&gt;  &lt;int&gt;       &lt;int&gt;            &lt;int&gt;            &lt;int&gt;
1             1     5     5      1          19               52              473
# ℹ 464 more variables: codigo_distrito_electoral &lt;int&gt;, numero_mesas &lt;int&gt;,
#   censo &lt;int&gt;, participacion_1 &lt;int&gt;, participacion_2 &lt;int&gt;,
#   votos_blancos &lt;int&gt;, votos_nulos &lt;int&gt;, votos_candidaturas &lt;int&gt;,
#   `BERDEAK-LOS VERDES` &lt;int&gt;, ARALAR &lt;int&gt;,
#   `PARTIDO OBRERO SOCIALISTA INTERNACIONALISTA` &lt;int&gt;,
#   `ALTERNATIVA MOTOR Y DEPORTES` &lt;int&gt;, `PARTIDO HUMANISTA` &lt;int&gt;,
#   `PARTIDO POPULAR` &lt;int&gt;, `EZKER BATUA-BERDEAK-ALTERNATIVA` &lt;int&gt;, …</code></pre>
</div>
</div>
<p>Esta función nos resume, evaluando todas las columnas, el número de distintos valores presentes. Aquellos con únicamente uno son los datos redundantes. Como se puede comprobar dichas variables a eliminar serán: <strong>tipo_eleccion, vuelta y codigo_distrito_electoral.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>siglas <span class="ot">&lt;-</span> <span class="fu">add_row</span>(siglas, <span class="at">denominacion=</span><span class="st">"OTROS"</span>, <span class="at">siglas=</span><span class="st">"OTROS"</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>datos_limpios <span class="ot">&lt;-</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  datos_elecciones <span class="sc">|&gt;</span> </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.logical), as.numeric)) <span class="sc">|&gt;</span> </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(tipo_eleccion, vuelta, codigo_distrito_electoral)) <span class="sc">|&gt;</span> </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(<span class="st">"BERDEAK-LOS VERDES"</span><span class="sc">:</span><span class="st">"COALICIÓN POR MELILLA"</span>), </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to=</span><span class="st">"partidos"</span>, <span class="at">values_to=</span><span class="st">"votos"</span>, <span class="at">values_drop_na =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">siglas=</span><span class="fu">case_when</span>(</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(partidos,<span class="st">"PARTIDO POPULAR|PARTIT POPULAR"</span>) <span class="sc">~</span> <span class="st">"PP"</span>, </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(partidos,<span class="st">"PSOE|(PARTIT|PARTIDO) (SOCIALISTA|SOCIALISTES)|(PARTIT|PARTIDO) (OBRERO|OBRER) (SOCIALISTA|SOCIALISTES)"</span>) <span class="sc">~</span> <span class="st">"PSOE"</span>, </span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(partidos,<span class="st">"CIUDADANOS|CIUTADANS"</span>) <span class="sc">~</span> <span class="st">"CS"</span>, </span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(partidos,<span class="st">"(NACIONALISTA&amp;VASCO)|PARTIDO NACIONALISTA VASCO|EUZKO ALDERDI JELTZALEA"</span>) <span class="sc">~</span> <span class="st">"EAJPNV"</span>, </span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(partidos,<span class="st">"(NACIONAL&amp;GAL)|(BLOQUE NACIONALISTA GALEGO)"</span>) <span class="sc">~</span> <span class="st">"BNG"</span>, </span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(partidos,<span class="st">"COMPROMÍS"</span>) <span class="sc">~</span> <span class="st">"MÉSCOMPROM"</span>, </span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(partidos,<span class="st">"CONVERGENCIA I UNIO|CONVERGÈNCIA I UNIÓ|CONVERGÈNCIA i UNIÓ"</span>) <span class="sc">~</span> <span class="st">"CIU"</span>, </span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(partidos,<span class="st">"PODEMOS|PODEM|VERDE|VERDES|VERDS|EZKER BATUA|MAREA|(UNIDAS|UNIDOS) (PODEM|PODEMOS)"</span>) <span class="sc">~</span> <span class="st">"PODEMOS"</span>, </span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(partidos,<span class="st">"CATALUNYA SÍ|ESQUERRA REPUBLICANA DE CATALUNYA"</span>) <span class="sc">~</span> <span class="st">"ERC"</span>, </span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(partidos,<span class="st">"EUSKAL HERRIA BILDU|ARALAR|SORTU|EUSKO ALKARTASUNA|ALTERNATIBA"</span>) <span class="sc">~</span> <span class="st">"EHBILDU"</span>, </span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(partidos,<span class="st">"MÁS PAÍS"</span>) <span class="sc">~</span> <span class="st">"MPAÍS"</span>, </span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(partidos,<span class="st">"VOX"</span>) <span class="sc">~</span> <span class="st">"VOX"</span>, </span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"OTROS"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(siglas, <span class="at">by=</span><span class="st">"siglas"</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cod_mun=</span><span class="fu">glue</span>(<span class="st">"{codigo_ccaa}-{codigo_provincia}-{codigo_municipio}"</span>), </span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">fecha=</span><span class="fu">ymd</span>(<span class="fu">glue</span>(<span class="st">"{anno}-{mes}-1"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fecha, cod_mun, siglas) <span class="sc">|&gt;</span> </span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">votos=</span><span class="fu">sum</span>(votos)) <span class="sc">|&gt;</span> </span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(fecha, cod_mun, siglas, <span class="at">.keep_all=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>partidos) <span class="sc">|&gt;</span> <span class="fu">relocate</span>(<span class="fu">c</span>(denominacion,siglas), <span class="at">.before=</span>votos) <span class="sc">|&gt;</span> </span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(cod_mun, <span class="at">.after=</span>codigo_municipio) <span class="sc">|&gt;</span> <span class="fu">relocate</span>(fecha, <span class="at">.after=</span>mes)</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>datos_limpios </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 246,769 × 17
    anno mes   fecha      codigo_ccaa codigo_provincia codigo_municipio cod_mun 
   &lt;dbl&gt; &lt;chr&gt; &lt;date&gt;     &lt;chr&gt;       &lt;chr&gt;            &lt;chr&gt;            &lt;glue&gt;  
 1  2008 03    2008-03-01 14          01               001              14-01-0…
 2  2008 03    2008-03-01 14          01               001              14-01-0…
 3  2008 03    2008-03-01 14          01               001              14-01-0…
 4  2008 03    2008-03-01 14          01               001              14-01-0…
 5  2008 03    2008-03-01 14          01               001              14-01-0…
 6  2008 03    2008-03-01 14          01               001              14-01-0…
 7  2008 03    2008-03-01 14          01               001              14-01-0…
 8  2008 03    2008-03-01 14          01               002              14-01-0…
 9  2008 03    2008-03-01 14          01               002              14-01-0…
10  2008 03    2008-03-01 14          01               002              14-01-0…
# ℹ 246,759 more rows
# ℹ 10 more variables: numero_mesas &lt;dbl&gt;, censo &lt;dbl&gt;, participacion_1 &lt;dbl&gt;,
#   participacion_2 &lt;dbl&gt;, votos_blancos &lt;dbl&gt;, votos_nulos &lt;dbl&gt;,
#   votos_candidaturas &lt;dbl&gt;, denominacion &lt;chr&gt;, siglas &lt;chr&gt;, votos &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="limpiar-encuestas" class="level3">
<h3 class="anchored" data-anchor-id="limpiar-encuestas">3. LIMPIAR ENCUESTAS</h3>
<p>Primero elimininamos aquellas anteriores a 2008, después aquellas a pies de urna, aquellas con tamaño inferior a 750 o desconocido, aquellas con menos de un día de trabajo y los datos redundantes, para luego completar todo el proceso necesario para el tidy data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>encuestas <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), n_distinct))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 59
  type_survey date_elec id_pollster pollster media field_date_from field_date_to
        &lt;int&gt;     &lt;int&gt;       &lt;int&gt;    &lt;int&gt; &lt;int&gt;           &lt;int&gt;         &lt;int&gt;
1           1        14          90       93    74            2447          2645
# ℹ 52 more variables: exit_poll &lt;int&gt;, size &lt;int&gt;, turnout &lt;int&gt;, UCD &lt;int&gt;,
#   PSOE &lt;int&gt;, PCE &lt;int&gt;, AP &lt;int&gt;, CIU &lt;int&gt;, PA &lt;int&gt;, `EAJ-PNV` &lt;int&gt;,
#   HB &lt;int&gt;, ERC &lt;int&gt;, EE &lt;int&gt;, CDS &lt;int&gt;, FN &lt;int&gt;, PAD &lt;int&gt;, PRD &lt;int&gt;,
#   MUC &lt;int&gt;, IU &lt;int&gt;, CG &lt;int&gt;, PAR &lt;int&gt;, AIC &lt;int&gt;, UV &lt;int&gt;, EA &lt;int&gt;,
#   PP &lt;int&gt;, LV &lt;int&gt;, ARM &lt;int&gt;, PDP &lt;int&gt;, CC &lt;int&gt;, PAP &lt;int&gt;, BNG &lt;int&gt;,
#   ICV &lt;int&gt;, EH &lt;int&gt;, UPYD &lt;int&gt;, AMAIUR &lt;int&gt;, CS &lt;int&gt;, `DIL-CDC` &lt;int&gt;,
#   `EH-BILDU` &lt;int&gt;, UP &lt;int&gt;, PACMA &lt;int&gt;, PODEMOS &lt;int&gt;, COMPROMIS &lt;int&gt;, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>encuestas_limpias <span class="ot">&lt;-</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  encuestas <span class="sc">|&gt;</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(date_elec)<span class="sc">&gt;=</span><span class="dv">2008</span>) <span class="sc">|&gt;</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(exit_poll<span class="sc">==</span><span class="cn">FALSE</span>) <span class="sc">|&gt;</span> <span class="co"># a pies de urna</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(size) <span class="sc">|&gt;</span> </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(size<span class="sc">&gt;</span><span class="dv">750</span>) <span class="sc">|&gt;</span> </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(field_date_to <span class="sc">-</span> field_date_from <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="co"># menos de un día de trabajo</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(type_survey,exit_poll)) <span class="sc">|&gt;</span> </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols=</span><span class="fu">c</span>(<span class="st">"UCD"</span><span class="sc">:</span><span class="st">"EV"</span>),</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to=</span><span class="st">"partidos"</span>,</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to=</span><span class="st">"estimacion_voto"</span>,</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_drop_na=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">partidos=</span> <span class="fu">case_when</span>(</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(partidos,<span class="st">"PSOE"</span> ) <span class="sc">~</span><span class="st">"PSOE"</span>,</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(partidos, <span class="st">"PP"</span>) <span class="sc">~</span> <span class="st">"PP"</span>,</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(partidos, <span class="st">"CS"</span>) <span class="sc">~</span> <span class="st">"CS"</span>,</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(partidos, <span class="st">"PNV"</span>) <span class="sc">~</span> <span class="st">"EAJPNV"</span>,</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(partidos, <span class="st">"BNG"</span>) <span class="sc">~</span> <span class="st">"BNG"</span>,</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(partidos, <span class="st">"COMPROMIS"</span>) <span class="sc">~</span> <span class="st">"MÉSCOMPROM"</span>,</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(partidos, <span class="st">"CIU"</span>) <span class="sc">~</span> <span class="st">"CIU"</span>,</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(partidos, <span class="st">"UP|PODEMOS"</span>) <span class="sc">~</span> <span class="st">"PODEMOS"</span>,</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(partidos, <span class="st">"ERC"</span>) <span class="sc">~</span> <span class="st">"ERC"</span>,</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(partidos, <span class="st">"EH-BILDU"</span>) <span class="sc">~</span> <span class="st">"EHBILDU"</span>,</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(partidos, <span class="st">"MP"</span>) <span class="sc">~</span> <span class="st">"MPAÍS"</span>,</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(partidos, <span class="st">"VOX"</span>) <span class="sc">~</span> <span class="st">"VOX"</span>,</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"OTROS"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date_elec,id_pollster, field_date_from, field_date_to, size, partidos) <span class="sc">|&gt;</span> </span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">est_voto_sigla=</span><span class="fu">sum</span>(estimacion_voto)) <span class="sc">|&gt;</span> </span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>estimacion_voto) <span class="sc">|&gt;</span> </span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(partidos, <span class="at">.keep_all=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>encuestas_limpias</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11,318 × 10
   date_elec  id_pollster pollster media     field_date_from field_date_to  size
   &lt;date&gt;     &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;     &lt;date&gt;          &lt;date&gt;        &lt;dbl&gt;
 1 2008-03-09 pollster-49 GESOP    EL PERIÓ… 2008-03-05      2008-03-07     1000
 2 2008-03-09 pollster-49 GESOP    EL PERIÓ… 2008-03-05      2008-03-07     1000
 3 2008-03-09 pollster-49 GESOP    EL PERIÓ… 2008-03-05      2008-03-07     1000
 4 2008-03-09 pollster-49 GESOP    EL PERIÓ… 2008-03-05      2008-03-07     1000
 5 2008-03-09 pollster-49 GESOP    EL PERIÓ… 2008-03-05      2008-03-07     1000
 6 2008-03-09 pollster-49 GESOP    EL PERIÓ… 2008-03-05      2008-03-07     1000
 7 2008-03-09 pollster-49 GESOP    EL PERIÓ… 2008-03-04      2008-03-06     1200
 8 2008-03-09 pollster-49 GESOP    EL PERIÓ… 2008-03-04      2008-03-06     1200
 9 2008-03-09 pollster-49 GESOP    EL PERIÓ… 2008-03-04      2008-03-06     1200
10 2008-03-09 pollster-49 GESOP    EL PERIÓ… 2008-03-04      2008-03-06     1200
# ℹ 11,308 more rows
# ℹ 3 more variables: turnout &lt;dbl&gt;, partidos &lt;chr&gt;, est_voto_sigla &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="trabajando-con-las-bases" class="level1">
<h1>2. Trabajando con las bases</h1>
<section id="tema-para-los-gráficos" class="level2">
<h2 class="anchored" data-anchor-id="tema-para-los-gráficos">Tema para los gráficos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(showtext)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'showtext' was built under R version 4.3.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: sysfonts</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'sysfonts' was built under R version 4.3.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: showtextdb</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'showtextdb' was built under R version 4.3.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sysfonts)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(peRReo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Descargar la fue  nte de google, p.e:</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">font_add_google</span>(<span class="at">name =</span> <span class="st">"Montserrat"</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Utilizar la fuente</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">showtext.auto</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>'showtext.auto()' is now renamed to 'showtext_auto()'
The old version still works, but consider using the new function in future code</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#tema</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Montserrat"</span>))</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_update</span>(</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"#EEC591"</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">size =</span> <span class="dv">4</span>, <span class="at">fill =</span> <span class="st">"seashell1"</span>),</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">25</span>),</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>), </span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>), </span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#EBEBEB"</span>),</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#EBEBEB"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `size` argument of `element_rect()` is deprecated as of ggplot2 3.4.0.
ℹ Please use the `linewidth` argument instead.</code></pre>
</div>
</div>
</section>
<section id="ejercicio-1" class="level2">
<h2 class="anchored" data-anchor-id="ejercicio-1">EJERCICIO 1</h2>
<p>¿Cómo se reparte el voto de partidos de ámbito nacional (PSOE, PP, VOX, CS, MP, UP - IU) frente a los partidos de corte autonómico o nacionalista?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Gráfico Barras</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>nacionalismo <span class="ot">&lt;-</span> </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  datos_limpios <span class="sc">|&gt;</span> </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">categoria=</span><span class="fu">case_when</span>(</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(siglas, <span class="st">"PSOE|PP|VOX|CS|MPAÍS|PODEMOS"</span>) <span class="sc">~</span> <span class="st">"nacional"</span>,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span><span class="st">"nacionalista"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">votos_t =</span> <span class="fu">sum</span>(votos), <span class="at">.by =</span> fecha) <span class="sc">|&gt;</span> </span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fecha,categoria) <span class="sc">|&gt;</span> </span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">prop_voto=</span><span class="dv">100</span><span class="sc">*</span><span class="fu">sum</span>(votos)<span class="sc">/</span>votos_t) <span class="sc">|&gt;</span> </span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(fecha, categoria, prop_voto)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nacionalismo) <span class="sc">+</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x=</span>categoria, <span class="at">y=</span>prop_voto, <span class="at">fill=</span>categoria)) <span class="sc">+</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>fecha, <span class="at">scales=</span><span class="st">"free_y"</span>) <span class="sc">+</span> <span class="co">#para que cada gráfica tenga su propia escala de y</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">latin_palette</span>(<span class="at">name=</span><span class="st">"rosalia"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>El voto de los partidos nacionales y nacionalistas se suelen repartir sobre un 80%, y un 20% aproximidamente respectivamente. Hay que destacar que en 2011 vemos que los partidos nacionalistas tuvieron más votos de lo habitual.</p>
</section>
<section id="ejercicio-2" class="level2">
<h2 class="anchored" data-anchor-id="ejercicio-2">EJERCICIO 2</h2>
<p>¿Cuál es el partido ganador en los municipios de más de 100 000 habitantes de censo en cada una de las elecciones?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>ganador <span class="ot">&lt;-</span> datos_limpios <span class="sc">|&gt;</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(censo<span class="sc">&gt;</span><span class="dv">100000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fecha,cod_mun) <span class="sc">|&gt;</span> </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(votos<span class="sc">==</span><span class="fu">max</span>(votos)) <span class="sc">|&gt;</span> </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cod_mun, <span class="at">by=</span><span class="st">"cod_mun"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(municipio, <span class="at">.after=</span>cod_mun) <span class="sc">|&gt;</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(fecha, municipio, siglas)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>ganador</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 282 × 3
   fecha      municipio                   siglas
   &lt;date&gt;     &lt;chr&gt;                       &lt;chr&gt; 
 1 2008-03-01 Vitoria-Gasteiz             PSOE  
 2 2008-03-01 Albacete                    PP    
 3 2008-03-01 Alicante/Alacant            PP    
 4 2008-03-01 Elche/Elx                   PP    
 5 2008-03-01 Almería                     PP    
 6 2008-03-01 Badajoz                     PP    
 7 2008-03-01 Palma                       PP    
 8 2008-03-01 Badalona                    OTROS 
 9 2008-03-01 Barcelona                   OTROS 
10 2008-03-01 Hospitalet de Llobregat, L' OTROS 
# ℹ 272 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ganador) <span class="sc">+</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> siglas, <span class="at">fill =</span> siglas),  <span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">color =</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#067c29"</span>, <span class="st">"#ffbf41"</span>,<span class="st">"#E0EEEE"</span>,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"#936bf4"</span>, <span class="st">"#0056a3"</span>, <span class="st">"#e40414"</span>,<span class="st">"#5ac035"</span>)) <span class="sc">+</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>fecha) <span class="sc">+</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Ganador en cada elección"</span>,</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Censo &gt; 100.000"</span>, </span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"nº municipios"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="ejercicio-3" class="level2">
<h2 class="anchored" data-anchor-id="ejercicio-3">EJERCICIO 3</h2>
<p>¿Qué partido fue el segundo cuando el primero fue el PSOE? ¿Y cuándo el primero fue el PP?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>n_votado <span class="ot">&lt;-</span> <span class="cf">function</span>(partidos, votos, <span class="at">n =</span> <span class="dv">1</span>) {</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  datos <span class="ot">&lt;-</span> <span class="fu">tibble</span>(partidos, votos) </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  siglas <span class="ot">&lt;-</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    datos <span class="sc">|&gt;</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(<span class="at">n =</span> n, votos, <span class="at">with_ties =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_min</span>(<span class="at">n =</span> <span class="dv">1</span>, votos, <span class="at">with_ties =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(partidos)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(siglas)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="co"># n = 1 te da el primero</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="co"># n = 2 te da el segundo con más votos</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="fu">n_votado</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "C"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">n_votado</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">6</span>), <span class="at">n=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "B"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>ganadores <span class="ot">&lt;-</span> datos_limpios <span class="sc">|&gt;</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fecha,siglas) <span class="sc">|&gt;</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">votos=</span><span class="fu">sum</span>(votos)) <span class="sc">|&gt;</span> </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ganador=</span> <span class="fu">n_votado</span>(siglas, votos),</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">segundo =</span> <span class="fu">n_votado</span>(siglas, votos, <span class="at">n =</span> <span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(fecha, ganador, segundo) <span class="sc">|&gt;</span> </span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'fecha'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># con el mutate se crean dos columnas con las siglas del ganador y segundo pero como se sigue teniendo varias filas por los diferentes partidos pues se hace el distinct para que por cada fecha haya solo un ganador y segundo</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ganador haya sido PSOE, ¿segundo?</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>sol1 <span class="ot">&lt;-</span> </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  ganadores <span class="sc">|&gt;</span> </span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fecha) <span class="sc">|&gt;</span> </span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ganador<span class="sc">==</span><span class="st">"PSOE"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(segundo) <span class="sc">|&gt;</span> </span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ganador haya sido PP, ¿segundo?</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>sol2 <span class="ot">&lt;-</span> </span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  ganadores <span class="sc">|&gt;</span> </span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fecha) <span class="sc">|&gt;</span> </span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ganador<span class="sc">==</span><span class="st">"PP"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(segundo) <span class="sc">|&gt;</span> </span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>El PSOE fue ganador en 2019-04-01, 2019-11-01, quedando en segundo lugar el PP</p>
<p>Cuando el PP ganó, 2008-03-01, 2011-11-01, 2015-12-01, 2016-06-01, quedó en segundo lugar el PSOE</p>
</section>
<section id="ejercicio-4" class="level2">
<h2 class="anchored" data-anchor-id="ejercicio-4">EJERCICIO 4</h2>
<p>¿En qué municipios de más 2000 habitantes de censo, provincias o autonomías la diferencia entre el ganador y el segundo es más elevada?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CÓDIGO MUNICIPIOS</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>codigo_municipio <span class="ot">&lt;-</span> datos_limpios <span class="sc">|&gt;</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(censo <span class="sc">&gt;</span> <span class="dv">2000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fecha, cod_mun) <span class="sc">|&gt;</span> </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop_voto =</span> votos <span class="sc">/</span> <span class="fu">sum</span>(votos)) <span class="sc">|&gt;</span> </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ganador =</span> <span class="fu">n_votado</span>(siglas, votos),</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">segundo =</span> <span class="fu">n_votado</span>(siglas, votos, <span class="at">n =</span> <span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(siglas <span class="sc">%in%</span> <span class="fu">c</span>(ganador, segundo)) <span class="sc">|&gt;</span> </span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diferencia =</span> <span class="cf">if</span> (<span class="fu">n</span>() <span class="sc">==</span> <span class="dv">2</span>) <span class="fu">abs</span>(<span class="dv">100</span> <span class="sc">*</span><span class="fu">diff</span>(prop_voto)) <span class="cf">else</span> <span class="cn">NA_real_</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(cod_mun, <span class="at">.keep_all=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fecha) <span class="sc">|&gt;</span> </span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> diferencia, <span class="at">n =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(fecha, <span class="fu">desc</span>(diferencia)) <span class="sc">|&gt;</span> </span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cod_mun, <span class="at">by=</span><span class="st">"cod_mun"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(municipio, <span class="at">.after=</span>cod_mun) <span class="sc">|&gt;</span> </span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(fecha,municipio,diferencia,ganador,segundo)</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>codigo_2008_municipio <span class="ot">&lt;-</span> codigo_municipio <span class="sc">|&gt;</span> </span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(fecha)<span class="sc">==</span><span class="dv">2008</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(diferencia))</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>codigo_2019_municipio <span class="ot">&lt;-</span> codigo_municipio <span class="sc">|&gt;</span> </span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(fecha)<span class="sc">==</span><span class="dv">2019</span> <span class="sc">&amp;</span> <span class="fu">month</span>(fecha)<span class="sc">==</span><span class="dv">11</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(diferencia))</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a><span class="co">#CÓDIGO PROVINCIAS</span></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>codigo_provincia <span class="ot">&lt;-</span> datos_limpios <span class="sc">|&gt;</span> </span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fecha, codigo_provincia, siglas) <span class="sc">|&gt;</span></span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">votos=</span><span class="fu">sum</span>(votos)) <span class="sc">|&gt;</span> </span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(fecha, codigo_provincia, siglas, votos) <span class="sc">|&gt;</span> </span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(fecha,codigo_provincia,siglas,votos) <span class="sc">|&gt;</span> </span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fecha,codigo_provincia) <span class="sc">|&gt;</span> </span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop_voto=</span>votos<span class="sc">/</span><span class="fu">sum</span>(votos)) <span class="sc">|&gt;</span> </span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ganador =</span> <span class="fu">n_votado</span>(siglas, votos),</span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a>         <span class="at">segundo =</span> <span class="fu">n_votado</span>(siglas, votos, <span class="at">n =</span> <span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(siglas <span class="sc">%in%</span> <span class="fu">c</span>(ganador, segundo)) <span class="sc">|&gt;</span> </span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diferencia=</span> <span class="dv">100</span> <span class="sc">*</span> <span class="fu">abs</span>(<span class="fu">diff</span>(prop_voto))) <span class="sc">|&gt;</span> </span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(codigo_provincia, <span class="at">.keep_all=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fecha) <span class="sc">|&gt;</span> </span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> diferencia, <span class="at">n =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(fecha, <span class="fu">desc</span>(diferencia)) <span class="sc">|&gt;</span> </span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(fecha, codigo_provincia, ganador, segundo, diferencia )</span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true" tabindex="-1"></a>codigo_2008_provincia <span class="ot">&lt;-</span> codigo_provincia <span class="sc">|&gt;</span> </span>
<span id="cb48-50"><a href="#cb48-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(fecha)<span class="sc">==</span><span class="dv">2008</span>)</span>
<span id="cb48-51"><a href="#cb48-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-52"><a href="#cb48-52" aria-hidden="true" tabindex="-1"></a>codigo_2019_provincia <span class="ot">&lt;-</span> codigo_provincia <span class="sc">|&gt;</span> </span>
<span id="cb48-53"><a href="#cb48-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(fecha)<span class="sc">==</span><span class="dv">2019</span> <span class="sc">&amp;</span> <span class="fu">month</span>(fecha)<span class="sc">==</span><span class="dv">11</span>)</span>
<span id="cb48-54"><a href="#cb48-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-55"><a href="#cb48-55" aria-hidden="true" tabindex="-1"></a><span class="co"># CÓDIGO COMUNIDADES</span></span>
<span id="cb48-56"><a href="#cb48-56" aria-hidden="true" tabindex="-1"></a>codigo_comunidades <span class="ot">&lt;-</span> datos_limpios <span class="sc">|&gt;</span> </span>
<span id="cb48-57"><a href="#cb48-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fecha, codigo_ccaa, siglas) <span class="sc">|&gt;</span></span>
<span id="cb48-58"><a href="#cb48-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">votos=</span><span class="fu">sum</span>(votos)) <span class="sc">|&gt;</span> </span>
<span id="cb48-59"><a href="#cb48-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(fecha, codigo_ccaa, siglas, votos) <span class="sc">|&gt;</span> </span>
<span id="cb48-60"><a href="#cb48-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(fecha,codigo_ccaa,siglas,votos) <span class="sc">|&gt;</span> </span>
<span id="cb48-61"><a href="#cb48-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb48-62"><a href="#cb48-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fecha,codigo_ccaa) <span class="sc">|&gt;</span> </span>
<span id="cb48-63"><a href="#cb48-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop_voto=</span>votos<span class="sc">/</span><span class="fu">sum</span>(votos)) <span class="sc">|&gt;</span> </span>
<span id="cb48-64"><a href="#cb48-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ganador =</span> <span class="fu">n_votado</span>(siglas, votos),</span>
<span id="cb48-65"><a href="#cb48-65" aria-hidden="true" tabindex="-1"></a>         <span class="at">segundo =</span> <span class="fu">n_votado</span>(siglas, votos, <span class="at">n =</span> <span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb48-66"><a href="#cb48-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(siglas <span class="sc">%in%</span> <span class="fu">c</span>(ganador, segundo)) <span class="sc">|&gt;</span> </span>
<span id="cb48-67"><a href="#cb48-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diferencia=</span> <span class="dv">100</span> <span class="sc">*</span> <span class="fu">abs</span>(<span class="fu">diff</span>(prop_voto))) <span class="sc">|&gt;</span> </span>
<span id="cb48-68"><a href="#cb48-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(codigo_ccaa, <span class="at">.keep_all=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-69"><a href="#cb48-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb48-70"><a href="#cb48-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fecha) <span class="sc">|&gt;</span> </span>
<span id="cb48-71"><a href="#cb48-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> diferencia, <span class="at">n =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-72"><a href="#cb48-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(fecha, <span class="fu">desc</span>(diferencia)) <span class="sc">|&gt;</span> </span>
<span id="cb48-73"><a href="#cb48-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb48-74"><a href="#cb48-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(fecha, codigo_ccaa, ganador, segundo, diferencia )</span>
<span id="cb48-75"><a href="#cb48-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-76"><a href="#cb48-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-77"><a href="#cb48-77" aria-hidden="true" tabindex="-1"></a>codigo_2008_ccaa <span class="ot">&lt;-</span> codigo_comunidades <span class="sc">|&gt;</span> </span>
<span id="cb48-78"><a href="#cb48-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(fecha)<span class="sc">==</span><span class="dv">2008</span>)</span>
<span id="cb48-79"><a href="#cb48-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-80"><a href="#cb48-80" aria-hidden="true" tabindex="-1"></a>codigo_2019_ccaa <span class="ot">&lt;-</span> codigo_comunidades <span class="sc">|&gt;</span> </span>
<span id="cb48-81"><a href="#cb48-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(fecha)<span class="sc">==</span><span class="dv">2019</span> <span class="sc">&amp;</span> <span class="fu">month</span>(fecha)<span class="sc">==</span><span class="dv">11</span>)</span>
<span id="cb48-82"><a href="#cb48-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-83"><a href="#cb48-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-84"><a href="#cb48-84" aria-hidden="true" tabindex="-1"></a><span class="co"># gráficos</span></span>
<span id="cb48-85"><a href="#cb48-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-86"><a href="#cb48-86" aria-hidden="true" tabindex="-1"></a><span class="co"># municipio</span></span>
<span id="cb48-87"><a href="#cb48-87" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(codigo_2008_municipio) <span class="sc">+</span></span>
<span id="cb48-88"><a href="#cb48-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">fct_reorder</span>(municipio, diferencia), </span>
<span id="cb48-89"><a href="#cb48-89" aria-hidden="true" tabindex="-1"></a>               <span class="at">y=</span>diferencia, <span class="at">fill=</span>diferencia)) <span class="sc">+</span></span>
<span id="cb48-90"><a href="#cb48-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"#a3c15f"</span>, <span class="at">high =</span> <span class="st">"#ad3a57"</span>, </span>
<span id="cb48-91"><a href="#cb48-91" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mid =</span> <span class="st">"#e8c07b"</span>, <span class="at">midpoint =</span> <span class="dv">65</span>) <span class="sc">+</span></span>
<span id="cb48-92"><a href="#cb48-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">"%"</span>)) <span class="sc">+</span></span>
<span id="cb48-93"><a href="#cb48-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb48-94"><a href="#cb48-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Municipio"</span>, <span class="at">y =</span> <span class="st">"Diferencia"</span>,</span>
<span id="cb48-95"><a href="#cb48-95" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"PROPORCIÓN DE DIFERENCIA ENTRE MUNICIPIOS EN 2008"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(codigo_2019_municipio) <span class="sc">+</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">fct_reorder</span>(municipio, diferencia), </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">y=</span>diferencia, <span class="at">fill=</span>diferencia)) <span class="sc">+</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"#a3c15f"</span>, <span class="at">high =</span> <span class="st">"#ad3a57"</span>, </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mid =</span> <span class="st">"#e8c07b"</span>, <span class="at">midpoint =</span> <span class="dv">55</span>) <span class="sc">+</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">"%"</span>)) <span class="sc">+</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Municipio"</span>, <span class="at">y =</span> <span class="st">"Diferencia"</span>,</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"PROPORCIÓN DE DIFERENCIA ENTRE MUNICIPIOS EN 2019"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># provincia</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(codigo_2008_provincia) <span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">fct_reorder</span>(codigo_provincia, diferencia), </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">y=</span>diferencia, <span class="at">fill=</span>diferencia)) <span class="sc">+</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"#6ed3cf"</span>, <span class="at">high =</span> <span class="st">"#e62739"</span>, </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mid =</span> <span class="st">"#ffb380"</span>, <span class="at">midpoint =</span> <span class="fl">22.5</span>) <span class="sc">+</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">"%"</span>)) <span class="sc">+</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Provincia"</span>, <span class="at">y =</span> <span class="st">"Diferencia"</span>,</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"PROPORCIÓN DE DIFERENCIA ENTRE PROVINCIAS EN 2008"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-13-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(codigo_2019_provincia) <span class="sc">+</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">fct_reorder</span>(codigo_provincia, diferencia), </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">y=</span>diferencia, <span class="at">fill=</span>diferencia)) <span class="sc">+</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"#6ed3cf"</span>, <span class="at">high =</span> <span class="st">"#e62739"</span>, </span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mid =</span> <span class="st">"#ffb380"</span>, <span class="at">midpoint =</span> <span class="fl">22.5</span>) <span class="sc">+</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">"%"</span>)) <span class="sc">+</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Provincia"</span>, <span class="at">y =</span> <span class="st">"Diferencia"</span>, </span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"PROPORCIÓN DE DIFERENCIA ENTRE PROVINCIAS EN 2019"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-13-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#comunidad</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(codigo_2008_ccaa) <span class="sc">+</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">fct_reorder</span>(codigo_ccaa, diferencia), </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">y=</span>diferencia, <span class="at">fill=</span>diferencia)) <span class="sc">+</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"#7EB5A6"</span>, <span class="at">high =</span> <span class="st">"#5E548E"</span>, </span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mid =</span> <span class="st">"#FFD97D"</span>, <span class="at">midpoint =</span> <span class="dv">17</span>) <span class="sc">+</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">"%"</span>)) <span class="sc">+</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Comunidad"</span>, <span class="at">y =</span> <span class="st">"Diferencia"</span>, </span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"PROPORCIÓN DE DIFERENCIA ENTRE COMUNIDADES EN 2008"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-13-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(codigo_2019_ccaa) <span class="sc">+</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">fct_reorder</span>(codigo_ccaa, diferencia), </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">y=</span>diferencia, <span class="at">fill=</span>diferencia)) <span class="sc">+</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"#7EB5A6"</span>, <span class="at">high =</span> <span class="st">"#5E548E"</span>, </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mid =</span> <span class="st">"#FFD97D"</span>, <span class="at">midpoint =</span> <span class="dv">17</span>) <span class="sc">+</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">"%"</span>)) <span class="sc">+</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Comunidad"</span>, <span class="at">y =</span> <span class="st">"Diferencia"</span>, </span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"PROPORCIÓN DE DIFERENCIA ENTRE COMUNIDADES EN 2019"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-13-6.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Vemos que las diferencia se ha ido reduciendo a lo largo de los años entre muncipios, provincias, y comunidades. Podemos decir que está la población más polarizada actualmente que en 2008. Asimismo, podemos ver que algunos municipios, provincias y comunidades han mantenido la diferencia saliendo en ambas gráficas.</p>
</section>
<section id="ejercicio-5" class="level2">
<h2 class="anchored" data-anchor-id="ejercicio-5">EJERCICIO 5</h2>
<p>¿Cuáles son los municipios con mayor porcentaje de votos nulos de España?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># porcentajes de votos nulos por municipio en cada elección</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>votos_nul <span class="ot">&lt;-</span> </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  datos_limpios <span class="sc">|&gt;</span> </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(fecha,cod_mun,votos_nulos,votos_candidaturas,votos_blancos) <span class="sc">|&gt;</span> </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(fecha,cod_mun,<span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">porcentaje_nulos=</span>votos_nulos<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span>(votos_candidaturas <span class="sc">+</span> votos_blancos),</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">.by =</span><span class="fu">c</span>(fecha,cod_mun)) <span class="sc">|&gt;</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(porcentaje_nulos)) <span class="sc">|&gt;</span> </span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cod_mun, <span class="at">by=</span><span class="st">"cod_mun"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(municipio, <span class="at">.before =</span> cod_mun) <span class="sc">|&gt;</span> </span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(fecha, municipio, porcentaje_nulos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(votos_nul <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">year</span>(fecha) <span class="sc">==</span> <span class="dv">2008</span>, porcentaje_nulos <span class="sc">&gt;</span> <span class="fl">6.5</span>), </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_reorder</span>(municipio, porcentaje_nulos), </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> porcentaje_nulos, <span class="at">fill =</span> porcentaje_nulos)) <span class="sc">+</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>,</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">midpoint =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">"%"</span>)) <span class="sc">+</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, porcentaje_nulos)), </span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span>  <span class="co"># Añadir etiquetas de texto</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Porcentaje de Votos Nulos por Municipio en 2008"</span>, </span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Porcentaje de Votos Nulos"</span>, </span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Municipio"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(votos_nul <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">year</span>(fecha) <span class="sc">==</span> <span class="dv">2011</span>, porcentaje_nulos <span class="sc">&gt;</span> <span class="dv">9</span>), </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_reorder</span>(municipio, porcentaje_nulos), </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> porcentaje_nulos, <span class="at">fill =</span> porcentaje_nulos)) <span class="sc">+</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">midpoint =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">"%"</span>)) <span class="sc">+</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, porcentaje_nulos)), </span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span>  <span class="co"># Añadir etiquetas de texto</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Porcentaje de Votos Nulos por Municipio en 2011"</span>, </span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Porcentaje de Votos Nulos"</span>, </span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Municipio"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(votos_nul <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">year</span>(fecha) <span class="sc">==</span> <span class="dv">2015</span>, porcentaje_nulos <span class="sc">&gt;</span> <span class="dv">8</span>), </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_reorder</span>(municipio, porcentaje_nulos), </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> porcentaje_nulos, <span class="at">fill =</span> porcentaje_nulos)) <span class="sc">+</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>,</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">midpoint =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">"%"</span>)) <span class="sc">+</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, porcentaje_nulos)),</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span>  <span class="co"># Añadir etiquetas de texto</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Porcentaje de Votos Nulos por Municipio en 2015"</span>, </span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Porcentaje de Votos Nulos"</span>, </span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Municipio"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(votos_nul <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">year</span>(fecha) <span class="sc">==</span> <span class="dv">2016</span>, porcentaje_nulos <span class="sc">&gt;</span> <span class="fl">7.5</span>), </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_reorder</span>(municipio, porcentaje_nulos), </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> porcentaje_nulos, <span class="at">fill =</span> porcentaje_nulos)) <span class="sc">+</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>,</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">midpoint =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">"%"</span>)) <span class="sc">+</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, porcentaje_nulos)), </span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span>  <span class="co"># Añadir etiquetas de texto</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Porcentaje de Votos Nulos por Municipio en 2016"</span>, </span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Porcentaje de Votos Nulos"</span>, </span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Municipio"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(votos_nul <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">year</span>(fecha) <span class="sc">==</span> <span class="dv">2019</span>, <span class="fu">month</span>(fecha) <span class="sc">==</span> <span class="dv">04</span>,</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>                           porcentaje_nulos <span class="sc">&gt;</span> <span class="dv">9</span>), </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_reorder</span>(municipio, porcentaje_nulos), <span class="at">x =</span> porcentaje_nulos, </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> porcentaje_nulos)) <span class="sc">+</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>,</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">midpoint =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">"%"</span>)) <span class="sc">+</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, porcentaje_nulos)), </span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span>  <span class="co"># Añadir etiquetas de texto</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Porcentaje de Votos Nulos por Municipio en 2019-04"</span>, </span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Porcentaje de Votos Nulos"</span>, </span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Municipio"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(votos_nul <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">year</span>(fecha) <span class="sc">==</span> <span class="dv">2019</span>, <span class="fu">month</span>(fecha) <span class="sc">==</span> <span class="dv">11</span>,</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>                           porcentaje_nulos <span class="sc">&gt;</span> <span class="dv">9</span>), </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_reorder</span>(municipio, porcentaje_nulos), <span class="at">x =</span> porcentaje_nulos, </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> porcentaje_nulos)) <span class="sc">+</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>,</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">midpoint =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">"%"</span>)) <span class="sc">+</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, porcentaje_nulos)), </span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span>  <span class="co"># Añadir etiquetas de texto</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Porcentaje de Votos Nulos por Municipio en 2019-11"</span>,</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Porcentaje de Votos Nulos"</span>, </span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Municipio"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># porcentaje medio de votos nulos por municipio &gt;&gt; que normalmente haya votos_nulos</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>votos_nul_medio <span class="ot">&lt;-</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  datos_limpios <span class="sc">|&gt;</span> </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(fecha,cod_mun,votos_nulos,votos_candidaturas,votos_blancos) <span class="sc">|&gt;</span> </span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(fecha,cod_mun,<span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">porcentaje_nulos=</span>votos_nulos<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span>(votos_candidaturas <span class="sc">+</span> votos_blancos),<span class="at">.by =</span><span class="fu">c</span>(fecha,cod_mun)) <span class="sc">|&gt;</span> </span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">media_nulos=</span><span class="fu">mean</span>(porcentaje_nulos),<span class="at">.by =</span> cod_mun) <span class="sc">|&gt;</span> </span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(media_nulos)) <span class="sc">|&gt;</span> </span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cod_mun, <span class="at">by=</span><span class="st">"cod_mun"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(municipio, <span class="at">.before =</span> cod_mun) <span class="sc">|&gt;</span> </span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(cod_mun, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(municipio, media_nulos)</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(votos_nul_medio <span class="sc">|&gt;</span> <span class="fu">filter</span>(media_nulos <span class="sc">&gt;</span> <span class="dv">5</span>), </span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_reorder</span>(municipio, media_nulos), </span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> media_nulos, <span class="at">fill =</span> media_nulos)) <span class="sc">+</span></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>,</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">midpoint =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">"%"</span>)) <span class="sc">+</span></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, media_nulos)), </span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span>  <span class="co"># Añadir etiquetas de texto</span></span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Municipios con mayor % de Votos Nulos"</span>, </span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Media de votos nulos en todas las eleccion"</span>,</span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Media Votos Nulos"</span>, </span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Municipio"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="ejercicio-6" class="level2">
<h2 class="anchored" data-anchor-id="ejercicio-6">EJERCICIO 6</h2>
<p>¿En qué sitios hay mayor participación? ¿Quién ganó en los sitios con mayor participación y donde menos? ¿A quién le beneficia la baja participación?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sitios con mayor participación y su ganador</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>maxi <span class="ot">&lt;-</span> </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  datos_limpios <span class="sc">|&gt;</span> </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fecha, cod_mun) <span class="sc">|&gt;</span> </span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">votos_mun =</span> <span class="fu">sum</span>(votos, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">prc_participacion =</span> <span class="dv">100</span><span class="sc">*</span>(votos_mun<span class="sc">+</span>votos_blancos<span class="sc">+</span>votos_nulos)<span class="sc">/</span>censo) <span class="sc">|&gt;</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(votos <span class="sc">==</span> <span class="fu">max</span>(votos)) <span class="sc">|&gt;</span> </span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(prc_participacion, <span class="at">n=</span><span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prc_participacion =</span> <span class="fu">if_else</span>(prc_participacion <span class="sc">&gt;</span> <span class="dv">100</span>, <span class="cn">NA</span>,prc_participacion)) <span class="sc">|&gt;</span> </span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cod_mun, <span class="at">by =</span> <span class="st">"cod_mun"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(municipio, <span class="at">.after =</span> cod_mun) <span class="sc">|&gt;</span> </span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(fecha, municipio, siglas, votos, prc_participacion)</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>maxi</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 169 × 5
   fecha      municipio                siglas votos prc_participacion
   &lt;date&gt;     &lt;chr&gt;                    &lt;chr&gt;  &lt;dbl&gt;             &lt;dbl&gt;
 1 2019-04-01 Alcolea de las Peñas     PP         4                NA
 2 2008-03-01 Blasconuño de Matacabras PP        11               100
 3 2008-03-01 San Esteban de los Patos PSOE      13               100
 4 2008-03-01 Vileña                   PP        22               100
 5 2008-03-01 Villaldemiro             PP        49               100
 6 2008-03-01 Castell de Cabres        PSOE       6               100
 7 2008-03-01 Castilnuevo              PP         5               100
 8 2008-03-01 Tortuero                 PSOE      15               100
 9 2008-03-01 Valdesotos               PP        19               100
10 2008-03-01 Gallinero de Cameros     PP        14               100
# ℹ 159 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># está tomando los 10 valores maximor del % que son 111 y 100 y devuelve todas las filas con dicho % </span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co"># al porcentaje mayor que 100 ponemos NA pues eso no existe, es como no conocerlo/tenerlo</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(maxi) <span class="sc">+</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> siglas, <span class="at">fill =</span> siglas),  <span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">color =</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#fa4f00"</span>,<span class="st">"#E0EEEE"</span>, <span class="st">"#936bf4"</span>,</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"#0056a3"</span>, <span class="st">"#e40414"</span>,<span class="st">"#5ac035"</span>)) <span class="sc">+</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>fecha) <span class="sc">+</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Ganador por municipio"</span>,</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Con 100% participación"</span>, </span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"nº municipios"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sitios con menor participación y su </span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>mini <span class="ot">&lt;-</span> </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  datos_limpios <span class="sc">|&gt;</span> </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fecha, cod_mun) <span class="sc">|&gt;</span> </span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">votos_mun =</span> <span class="fu">sum</span>(votos, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">prc_participacion =</span> <span class="dv">100</span><span class="sc">*</span>(votos_mun<span class="sc">+</span>votos_blancos)<span class="sc">/</span>censo) <span class="sc">|&gt;</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(votos <span class="sc">==</span> <span class="fu">max</span>(votos)) <span class="sc">|&gt;</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_min</span>(prc_participacion, <span class="at">n=</span><span class="dv">30</span>) <span class="sc">|&gt;</span> </span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cod_mun, <span class="at">by =</span> <span class="st">"cod_mun"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(municipio, <span class="at">.after =</span> cod_mun) <span class="sc">|&gt;</span> </span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(fecha, municipio, siglas, votos, prc_participacion) <span class="sc">|&gt;</span> </span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(fecha)</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>mini</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30 × 5
   fecha      municipio  siglas  votos prc_participacion
   &lt;date&gt;     &lt;chr&gt;      &lt;chr&gt;   &lt;dbl&gt;             &lt;dbl&gt;
 1 2008-03-01 Orexa      EAJPNV      1              2.11
 2 2008-03-01 Baliarrain EAJPNV      8             16.0 
 3 2008-03-01 Lizartza   EAJPNV     43             17.0 
 4 2008-03-01 Goizueta   OTROS      99             19.5 
 5 2008-03-01 Elduain    EAJPNV     25             24.0 
 6 2008-03-01 Leaburu    EAJPNV     51             24.5 
 7 2008-03-01 Aduna      EAJPNV     31             24.6 
 8 2008-03-01 Errezil    EAJPNV    107             25.3 
 9 2008-03-01 Aulesti    EAJPNV    124             25.4 
10 2008-03-01 Belauntza  EHBILDU    24             25.4 
# ℹ 20 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mini) <span class="sc">+</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> siglas, <span class="at">fill =</span> siglas),  <span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">color =</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#fa4f00"</span>,<span class="st">"#E0EEEE"</span>, <span class="st">"#936bf4"</span>,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"#0056a3"</span>, <span class="st">"#e40414"</span>,<span class="st">"#5ac035"</span>)) <span class="sc">+</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>fecha) <span class="sc">+</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Ganador por municipio"</span>,</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Con participación baja"</span>, </span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"nº municipios"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Como se puede observar el PP tiene predominancia en los municipios con mayor participación mientras que, el EAJPNV se ve beneficiado en los sitios con menor participación.</p>
</section>
<section id="ejercicio-7" class="level2">
<h2 class="anchored" data-anchor-id="ejercicio-7">EJERCICIO 7</h2>
<p>¿Cómo analizar la relación entre censo y voto? ¿Es cierto que ciertos partidos ganan lo rural?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>relacion <span class="ot">&lt;-</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  datos_limpios <span class="sc">|&gt;</span> </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">porc_part =</span> ((<span class="fu">sum</span>(votos)<span class="sc">+</span>votos_blancos<span class="sc">+</span>votos_nulos)<span class="sc">*</span><span class="dv">100</span>)<span class="sc">/</span>censo,</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">.by =</span> <span class="fu">c</span>(fecha, cod_mun)) <span class="sc">|&gt;</span> </span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(fecha, cod_mun, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fecha, censo <span class="sc">&gt;</span> <span class="dv">10000</span> ) <span class="sc">|&gt;</span> </span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">porc_part_promedio =</span> <span class="fu">mean</span>(porc_part, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'fecha'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular el número de victorias por partido y ciudad</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>victorias <span class="ot">&lt;-</span> datos_limpios <span class="sc">|&gt;</span> </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fecha, cod_mun) <span class="sc">|&gt;</span> </span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(votos <span class="sc">==</span> <span class="fu">max</span>(votos)) <span class="sc">|&gt;</span> </span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fecha, <span class="at">ciudad =</span> (censo <span class="sc">&gt;</span> <span class="dv">10000</span>), siglas) <span class="sc">|&gt;</span> </span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(siglas) <span class="sc">|&gt;</span> </span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">victorias=</span>n) <span class="sc">|&gt;</span> </span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fecha, ciudad) <span class="sc">|&gt;</span> </span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">victorias_t =</span> <span class="fu">sum</span>(victorias, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular el porcentaje de victorias</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>porc_victorias <span class="ot">&lt;-</span> victorias <span class="sc">|&gt;</span> </span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">porc_vict =</span> <span class="fu">case_when</span>(</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>    ciudad <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">~</span> victorias <span class="sc">*</span> <span class="dv">100</span> <span class="sc">/</span> victorias_t,</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>    ciudad <span class="sc">==</span> <span class="cn">FALSE</span> <span class="sc">~</span> victorias <span class="sc">*</span> <span class="dv">100</span> <span class="sc">/</span> victorias_t</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>graf <span class="ot">&lt;-</span> </span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(porc_victorias <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">year</span>(fecha)<span class="sc">==</span><span class="dv">2015</span>)) <span class="sc">+</span></span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> ciudad, <span class="at">fill =</span> siglas, <span class="at">y =</span> porc_vict), </span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">position =</span> <span class="st">"dodge2"</span>) <span class="sc">+</span></span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#fa4f00"</span>, <span class="st">"#067c29"</span>,<span class="st">"#08ccb4"</span>, <span class="st">"#ffbf41"</span>,</span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"#d6502a"</span>, <span class="st">"grey"</span>, <span class="st">"#936bf4"</span>,</span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"#0056a3"</span>, <span class="st">"#e40414"</span>,<span class="st">"#5ac035"</span>)) <span class="sc">+</span></span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">"%"</span>)) <span class="sc">+</span></span>
<span id="cb71-28"><a href="#cb71-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"% Victorias en 2015"</span>,</span>
<span id="cb71-29"><a href="#cb71-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Rural vs Ciudades"</span>)</span>
<span id="cb71-30"><a href="#cb71-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-31"><a href="#cb71-31" aria-hidden="true" tabindex="-1"></a>graf2 <span class="ot">&lt;-</span> </span>
<span id="cb71-32"><a href="#cb71-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(porc_victorias <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">year</span>(fecha)<span class="sc">==</span><span class="dv">2019</span>, <span class="fu">month</span>(fecha) <span class="sc">==</span> <span class="dv">11</span>)) <span class="sc">+</span></span>
<span id="cb71-33"><a href="#cb71-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> ciudad, <span class="at">fill =</span> siglas, <span class="at">y =</span> porc_vict), </span>
<span id="cb71-34"><a href="#cb71-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">position =</span> <span class="st">"dodge2"</span>)<span class="sc">+</span></span>
<span id="cb71-35"><a href="#cb71-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#74b4dc"</span>, <span class="st">"#fa4f00"</span>, <span class="st">"#067c29"</span>,<span class="st">"#08ccb4"</span>,</span>
<span id="cb71-36"><a href="#cb71-36" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"#ffbf41"</span>, <span class="st">"#d6502a"</span>, <span class="st">"grey"</span>, <span class="st">"#936bf4"</span>,</span>
<span id="cb71-37"><a href="#cb71-37" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"#0056a3"</span>, <span class="st">"#e40414"</span>,<span class="st">"#5ac035"</span>))  <span class="sc">+</span></span>
<span id="cb71-38"><a href="#cb71-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">"%"</span>)) <span class="sc">+</span></span>
<span id="cb71-39"><a href="#cb71-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"% Victorias en 2019-11"</span>,</span>
<span id="cb71-40"><a href="#cb71-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Rural vs Ciudades"</span>)</span>
<span id="cb71-41"><a href="#cb71-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-42"><a href="#cb71-42" aria-hidden="true" tabindex="-1"></a>plotly<span class="sc">::</span><span class="fu">ggplotly</span>(graf <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-523d131196fd4989890f" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-523d131196fd4989890f">{"x":{"data":[{"orientation":"v","width":[0.080999999999999961,0.089999999999999858],"base":[0,0],"x":[1.2250000000000001,2.2999999999999998],"y":[60.131319763624425,54.109589041095887],"text":["ciudad: FALSE<br />porc_vict: 60.13131976<br />siglas: PP","ciudad:  TRUE<br />porc_vict: 54.10958904<br />siglas: PP"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,86,163,0.75)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.080999999999999961,0.089999999999999858],"base":[0,0],"x":[0.68500000000000005,1.6999999999999997],"y":[1.4182534471437951,2.2260273972602738],"text":["ciudad: FALSE<br />porc_vict:  1.41825345<br />siglas: EAJPNV","ciudad:  TRUE<br />porc_vict:  2.22602740<br />siglas: EAJPNV"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(6,124,41,0.75)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.080999999999999961,0.089999999999999858],"base":[0,0],"x":[0.77500000000000002,1.7999999999999998],"y":[1.2475377544320421,0.51369863013698636],"text":["ciudad: FALSE<br />porc_vict:  1.24753775<br />siglas: EHBILDU","ciudad:  TRUE<br />porc_vict:  0.51369863<br />siglas: EHBILDU"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(8,204,180,0.75)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.080999999999999961,"base":0,"x":[1.405],"y":[0.013131976362442548],"text":"ciudad: FALSE<br />porc_vict:  0.01313198<br />siglas: VOX","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(90,192,53,0.75)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.080999999999999961,0.089999999999999858],"base":[0,0],"x":[1.135,2.2000000000000002],"y":[2.4425476034143139,13.356164383561644],"text":["ciudad: FALSE<br />porc_vict:  2.44254760<br />siglas: PODEMOS","ciudad:  TRUE<br />porc_vict: 13.35616438<br />siglas: PODEMOS"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(147,107,244,0.75)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.080999999999999961,0.089999999999999858],"base":[0,0],"x":[0.95500000000000007,2],"y":[1.2606697307944845,3.2534246575342465],"text":["ciudad: FALSE<br />porc_vict:  1.26066973<br />siglas: MÉSCOMPROM","ciudad:  TRUE<br />porc_vict:  3.25342466<br />siglas: MÉSCOMPROM"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(214,80,42,0.75)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.080999999999999961,0.089999999999999858],"base":[0,0],"x":[1.3149999999999999,2.4000000000000004],"y":[19.3827971109652,13.86986301369863],"text":["ciudad: FALSE<br />porc_vict: 19.38279711<br />siglas: PSOE","ciudad:  TRUE<br />porc_vict: 13.86986301<br />siglas: PSOE"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(228,4,20,0.75)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.080999999999999961,0.089999999999999858],"base":[0,0],"x":[0.59499999999999997,1.5999999999999999],"y":[0.28890347997373605,0.51369863013698636],"text":["ciudad: FALSE<br />porc_vict:  0.28890348<br />siglas: CS","ciudad:  TRUE<br />porc_vict:  0.51369863<br />siglas: CS"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(250,79,0,0.75)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.080999999999999961,0.089999999999999858],"base":[0,0],"x":[0.86499999999999999,1.8999999999999999],"y":[1.2212738017071569,0.34246575342465752],"text":["ciudad: FALSE<br />porc_vict:  1.22127380<br />siglas: ERC","ciudad:  TRUE<br />porc_vict:  0.34246575<br />siglas: ERC"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,191,65,0.75)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.080999999999999961,0.089999999999999858],"base":[0,0],"x":[1.0449999999999999,2.0999999999999996],"y":[12.593565331582402,11.815068493150685],"text":["ciudad: FALSE<br />porc_vict: 12.59356533<br />siglas: OTROS","ciudad:  TRUE<br />porc_vict: 11.81506849<br />siglas: OTROS"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,0.75)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":59.437110834371111,"r":7.3059360730593621,"b":40.182648401826491,"l":43.105022831050235},"paper_bgcolor":"rgba(255,245,238,1)","font":{"color":"rgba(0,0,0,1)","family":"Montserrat","size":14.611872146118724},"title":{"text":"<b> % Victorias en 2015 <\/b>","font":{"color":"rgba(0,0,0,1)","family":"Montserrat","size":33.208800332088011},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,2.6000000000000001],"tickmode":"array","ticktext":["FALSE","TRUE"],"tickvals":[1,2],"categoryorder":"array","categoryarray":["FALSE","TRUE"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"Montserrat","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"<b> ciudad <\/b>","font":{"color":"rgba(0,0,0,1)","family":"Montserrat","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.0065659881812214,63.137885751805648],"tickmode":"array","ticktext":["0%","20%","40%","60%"],"tickvals":[0,20,40,60],"categoryorder":"array","categoryarray":["0%","20%","40%","60%"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"Montserrat","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"<b> porc_vict <\/b>","font":{"color":"rgba(0,0,0,1)","family":"Montserrat","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"Montserrat","size":11.68949771689498},"title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"Montserrat","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"1dbc1b733ff7":{"x":{},"y":{},"fill":{},"type":"bar"}},"cur_data":"1dbc1b733ff7","visdat":{"1dbc1b733ff7":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>plotly<span class="sc">::</span><span class="fu">ggplotly</span>(graf2 <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-d2d86e12bc52fb508bf5" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-d2d86e12bc52fb508bf5">{"x":{"data":[{"orientation":"v","width":[0.073636363636363722,0.11571428571428566],"base":[0,0],"x":[1.2454545454545456,2.1285714285714281],"y":[36.584410497453973,12.606473594548552],"text":["ciudad: FALSE<br />porc_vict: 36.58441050<br />siglas: PP","ciudad:  TRUE<br />porc_vict: 12.60647359<br />siglas: PP"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,86,163,0.75)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.073636363636363722,0.11571428571428566],"base":[0,0],"x":[0.75454545454545452,1.6142857142857141],"y":[1.7234625930278105,3.5775127768313459],"text":["ciudad: FALSE<br />porc_vict:  1.72346259<br />siglas: EAJPNV","ciudad:  TRUE<br />porc_vict:  3.57751278<br />siglas: EAJPNV"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(6,124,41,0.75)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.073636363636363722,0.11571428571428566],"base":[0,0],"x":[0.83636363636363631,1.7428571428571427],"y":[2.1021021021021022,0.68143100511073251],"text":["ciudad: FALSE<br />porc_vict:  2.10210210<br />siglas: EHBILDU","ciudad:  TRUE<br />porc_vict:  0.68143101<br />siglas: EHBILDU"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(8,204,180,0.75)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.073636363636363722,0.11571428571428566],"base":[0,0],"x":[1.4090909090909092,2.3857142857142852],"y":[3.3946990468729599,6.9846678023850082],"text":["ciudad: FALSE<br />porc_vict:  3.39469905<br />siglas: VOX","ciudad:  TRUE<br />porc_vict:  6.98466780<br />siglas: VOX"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(90,192,53,0.75)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.073636363636363722,"base":0,"x":[0.59090909090909094],"y":[0.01305653479566523],"text":"ciudad: FALSE<br />porc_vict:  0.01305653<br />siglas: BNG","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(116,180,220,0.75)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.073636363636363722,"base":0,"x":[1.1636363636363636],"y":[0.82256169212690955],"text":"ciudad: FALSE<br />porc_vict:  0.82256169<br />siglas: PODEMOS","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(147,107,244,0.75)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.073636363636363722,"base":0,"x":[1],"y":[0.039169604386995689],"text":"ciudad: FALSE<br />porc_vict:  0.03916960<br />siglas: MÉSCOMPROM","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(214,80,42,0.75)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.073636363636363722,0.11571428571428566],"base":[0,0],"x":[1.3272727272727272,2.2571428571428571],"y":[41.062801932367151,58.432708688245313],"text":["ciudad: FALSE<br />porc_vict: 41.06280193<br />siglas: PSOE","ciudad:  TRUE<br />porc_vict: 58.43270869<br />siglas: PSOE"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(228,4,20,0.75)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.073636363636363722,"base":0,"x":[0.67272727272727273],"y":[0.091395743569656615],"text":"ciudad: FALSE<br />porc_vict:  0.09139574<br />siglas: CS","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(250,79,0,0.75)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.073636363636363722,0.11571428571428566],"base":[0,0],"x":[0.91818181818181821,1.8714285714285712],"y":[0.80950515733124428,0.34071550255536626],"text":["ciudad: FALSE<br />porc_vict:  0.80950516<br />siglas: ERC","ciudad:  TRUE<br />porc_vict:  0.34071550<br />siglas: ERC"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,191,65,0.75)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.073636363636363722,0.11571428571428588],"base":[0,0],"x":[1.0818181818181816,2],"y":[13.356835095965531,17.37649063032368],"text":["ciudad: FALSE<br />porc_vict: 13.35683510<br />siglas: OTROS","ciudad:  TRUE<br />porc_vict: 17.37649063<br />siglas: OTROS"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,0.75)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":59.437110834371111,"r":7.3059360730593621,"b":40.182648401826491,"l":43.105022831050235},"paper_bgcolor":"rgba(255,245,238,1)","font":{"color":"rgba(0,0,0,1)","family":"Montserrat","size":14.611872146118724},"title":{"text":"<b> % Victorias en 2019-11 <\/b>","font":{"color":"rgba(0,0,0,1)","family":"Montserrat","size":33.208800332088011},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,2.6000000000000001],"tickmode":"array","ticktext":["FALSE","TRUE"],"tickvals":[1,2],"categoryorder":"array","categoryarray":["FALSE","TRUE"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"Montserrat","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"<b> ciudad <\/b>","font":{"color":"rgba(0,0,0,1)","family":"Montserrat","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-2.9216354344122659,61.354344122657579],"tickmode":"array","ticktext":["0%","20%","40%","60%"],"tickvals":[0,20,40,60],"categoryorder":"array","categoryarray":["0%","20%","40%","60%"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"Montserrat","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"<b> porc_vict <\/b>","font":{"color":"rgba(0,0,0,1)","family":"Montserrat","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"Montserrat","size":11.68949771689498},"title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"Montserrat","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"1dbc1ae6d52":{"x":{},"y":{},"fill":{},"type":"bar"}},"cur_data":"1dbc1ae6d52","visdat":{"1dbc1ae6d52":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><strong>Gráfica 2015:</strong> El primero y el segundo se mantuvieron en ambos lugares, pero sin embargo, podemos ver que en las ciudades predomina más el voto de Podemos (que se encuentra en tercer lugar) que en lo rural</p>
<p><strong>Gráfica 2019-11:</strong> A lo largo de los años el PSOE ha ido ganando más votos en lo rural y en las ciudades, siendo la diferencia con el resto de partidos mayor en estas.</p>
</section>
<section id="ejercicio-8" class="level2">
<h2 class="anchored" data-anchor-id="ejercicio-8">EJERCICIO 8</h2>
<p>¿Cómo calibrar el error de las encuestas? ¿Cómo visualizarlo? (recuerda que las encuestas son intención de voto a nivel nacional)</p>
<section id="en-general-para-lo-demás" class="level3">
<h3 class="anchored" data-anchor-id="en-general-para-lo-demás">EN GENERAL PARA LO DEMÁS</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>votos_partido <span class="ot">&lt;-</span> datos_limpios <span class="sc">|&gt;</span> </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fecha,siglas) <span class="sc">|&gt;</span> </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">votos_nac=</span><span class="fu">sum</span>(votos)) <span class="sc">|&gt;</span> </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year=</span><span class="fu">year</span>(fecha), <span class="at">month=</span><span class="fu">month</span>(fecha)) <span class="co"># para porder unir con encuestas</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'fecha'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>votos_total <span class="ot">&lt;-</span> datos_limpios <span class="sc">|&gt;</span> </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fecha) <span class="sc">|&gt;</span> </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_voto=</span> <span class="fu">sum</span>(votos)) <span class="co"># para tener cuantos han sido los votos totales</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>votos_partido <span class="ot">&lt;-</span> votos_partido <span class="sc">|&gt;</span> </span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(votos_total, <span class="at">by=</span><span class="st">"fecha"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop_voto =</span> (votos_nac <span class="sc">*</span> <span class="dv">100</span>)<span class="sc">/</span>total_voto) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="código-para-casas-encuestadoras-y-partidos" class="level3">
<h3 class="anchored" data-anchor-id="código-para-casas-encuestadoras-y-partidos">CÓDIGO PARA CASAS ENCUESTADORAS Y PARTIDOS</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CÓDIGO PARA CASAS ENCUESTADORAS Y PARTIDOS</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>int_voto_casa <span class="ot">&lt;-</span> encuestas_limpias <span class="sc">|&gt;</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year=</span><span class="fu">year</span>(date_elec), <span class="at">month=</span><span class="fu">month</span>(date_elec))  <span class="sc">|&gt;</span> </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id_pollster, pollster, est_voto_sigla, partidos, year, month)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>error_casa_encuestadora <span class="ot">&lt;-</span> votos_partido <span class="sc">|&gt;</span> </span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(int_voto_casa, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"siglas"</span><span class="ot">=</span><span class="st">"partidos"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year,month,siglas, id_pollster) <span class="sc">|&gt;</span> </span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">est_voto_sigla=</span><span class="fu">mean</span>(est_voto_sigla)) <span class="sc">|&gt;</span> </span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id_pollster, <span class="at">.keep_all=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diferencia =</span> est_voto_sigla <span class="sc">-</span> prop_voto ) <span class="sc">|&gt;</span> </span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(fecha, siglas, id_pollster, pollster, prop_voto, est_voto_sigla, diferencia)</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>error_casa_encuestadora</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 880 × 7
   fecha      siglas id_pollster pollster    prop_voto est_voto_sigla diferencia
   &lt;date&gt;     &lt;chr&gt;  &lt;chr&gt;       &lt;chr&gt;           &lt;dbl&gt;          &lt;dbl&gt;      &lt;dbl&gt;
 1 2008-03-01 BNG    pollster-18 SIGMA DOS       0.835           0.8     -0.0354
 2 2008-03-01 BNG    pollster-51 OBRADOIRO …     0.835           1        0.165 
 3 2008-03-01 BNG    pollster-38 SONDAXE         0.835           1.1      0.265 
 4 2008-03-01 BNG    pollster-55 APPEND          0.835           0.6     -0.235 
 5 2008-03-01 BNG    pollster-19 CIS             0.835           0.9      0.0646
 6 2008-03-01 BNG    pollster-43 CELESTE-TEL     0.835           1.45     0.615 
 7 2008-03-01 BNG    pollster-57 IBERCONSUL…     0.835           1.45     0.615 
 8 2008-03-01 BNG    pollster-45 NOXA            0.835           1        0.165 
 9 2008-03-01 CIU    pollster-49 GESOP           3.09            3.93     0.837 
10 2008-03-01 CIU    pollster-48 DEMOMÉTRICA     3.09            9.5      6.41  
# ℹ 870 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Para las gráficas </span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>media_global_psoe <span class="ot">&lt;-</span> error_casa_encuestadora <span class="sc">|&gt;</span> </span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fecha<span class="sc">==</span><span class="st">"2008-03-01"</span>, siglas<span class="sc">==</span><span class="st">"PSOE"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">media_global=</span><span class="fu">mean</span>(diferencia)) <span class="sc">|&gt;</span> </span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(media_global) <span class="sc">|&gt;</span> </span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(media_global)</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>error_psoe <span class="ot">&lt;-</span> error_casa_encuestadora <span class="sc">|&gt;</span> </span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fecha<span class="sc">==</span><span class="st">"2008-03-01"</span>, siglas<span class="sc">==</span><span class="st">"PSOE"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(pollster, <span class="at">.keep_all=</span><span class="cn">TRUE</span>)</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>error_psoe <span class="sc">|&gt;</span> </span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">fct_reorder</span>(pollster, diferencia), <span class="at">y =</span> diferencia)) <span class="sc">+</span> </span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> diferencia)) <span class="sc">+</span></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"#a3c15f"</span>, <span class="at">high =</span> <span class="st">"#ad3a57"</span>,</span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mid =</span> <span class="st">"#e8c07b"</span>, <span class="at">midpoint =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">round</span>(media_global_psoe)) <span class="sc">+</span></span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Diferencia"</span>,</span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Casas encuestadoras"</span>,</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Diferencia"</span>,</span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Error PSOE en elecciones de 2008"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2019</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>media_global_psoe_2019 <span class="ot">&lt;-</span> error_casa_encuestadora <span class="sc">|&gt;</span> </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fecha<span class="sc">==</span><span class="st">"2019-11-01"</span>, siglas<span class="sc">==</span><span class="st">"PSOE"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">media_global=</span><span class="fu">mean</span>(diferencia)) <span class="sc">|&gt;</span> </span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(media_global) <span class="sc">|&gt;</span> </span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(media_global)</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>error_psoe_2019 <span class="ot">&lt;-</span> error_casa_encuestadora <span class="sc">|&gt;</span> </span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fecha<span class="sc">==</span><span class="st">"2019-11-01"</span>, siglas<span class="sc">==</span><span class="st">"PSOE"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(pollster, <span class="at">.keep_all=</span><span class="cn">TRUE</span>)</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>error_psoe_2019 <span class="sc">|&gt;</span> </span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">fct_reorder</span>(pollster, diferencia), <span class="at">y =</span> diferencia)) <span class="sc">+</span> </span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> diferencia)) <span class="sc">+</span></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"#a3c15f"</span>, <span class="at">high =</span> <span class="st">"#ad3a57"</span>,</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mid =</span> <span class="st">"#e8c07b"</span>, <span class="at">midpoint =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">round</span>(media_global_psoe_2019)) <span class="sc">+</span></span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Diferencia"</span>,</span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Casas encuestadoras"</span>,</span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Diferencia"</span>,</span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Error PSOE en elecciones de 2019"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-29-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Concretando para el PSOE, como podemos comprobar el error medio ha disminuido desde 2008 hasta las últimas elecciones en 2019. Aún así, las encuestas suelen dar al PSOE más votos de lo que realmente luego obtienen en las encuestas.</p>
</section>
<section id="código-por-partidos" class="level3">
<h3 class="anchored" data-anchor-id="código-por-partidos">CÓDIGO POR PARTIDOS</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CÓDIGO POR PARTIDO</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>int_voto <span class="ot">&lt;-</span> encuestas_limpias <span class="sc">|&gt;</span> </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date_elec, partidos) <span class="sc">|&gt;</span> </span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">int_voto=</span><span class="fu">mean</span>(est_voto_sigla)) <span class="sc">|&gt;</span> </span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year=</span><span class="fu">year</span>(date_elec), <span class="at">month=</span><span class="fu">month</span>(date_elec)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'date_elec'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> votos_partido <span class="sc">|&gt;</span> </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(int_voto, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"siglas"</span><span class="ot">=</span><span class="st">"partidos"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>date_elec, <span class="sc">-</span>year, <span class="sc">-</span>month) <span class="sc">|&gt;</span> </span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diferencia=</span><span class="fu">abs</span>(int_voto<span class="sc">-</span>prop_voto))</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="co"># hacer el inner join nos da lo mismo que hacer left join con filter(!is.na(int_voto))</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>error <span class="sc">|&gt;</span> </span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>fecha, <span class="at">y=</span>diferencia, <span class="at">fill =</span> fecha)) <span class="sc">+</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>siglas, <span class="at">scales=</span><span class="st">"free_y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> error <span class="sc">|&gt;</span> </span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>siglas, <span class="at">y=</span>diferencia, <span class="at">fill =</span> siglas)) <span class="sc">+</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#74b4dc"</span>, <span class="st">"#1c3687"</span>, <span class="st">"#fa4f00"</span>,<span class="st">"#067c29"</span>,</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"#08ccb4"</span>, <span class="st">"#ffbf41"</span>, <span class="st">"#d6502a"</span>,<span class="st">"#167c6c"</span>,</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"grey"</span>, <span class="st">"#936bf4"</span>,  </span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"#0056a3"</span>, <span class="st">"#e40414"</span>,<span class="st">"#5ac035"</span>)) <span class="sc">+</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>fecha, <span class="at">scales=</span><span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>()) </span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>plotly<span class="sc">::</span><span class="fu">ggplotly</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-b3ce94a5057fbd075c68" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-b3ce94a5057fbd075c68">{"x":{"data":[{"orientation":"v","width":0.89999999999999991,"base":0,"x":[1],"y":[0.24790438707699902],"text":"siglas: BNG<br />diferencia:  0.24790439<br />siglas: BNG","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(116,180,220,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"BNG","legendgroup":"BNG","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999991,"base":0,"x":[1],"y":[0.31597701367579756],"text":"siglas: BNG<br />diferencia:  0.31597701<br />siglas: BNG","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(116,180,220,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"BNG","legendgroup":"BNG","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000013,"base":0,"x":[2],"y":[0.19561341121787068],"text":"siglas: CIU<br />diferencia:  0.19561341<br />siglas: CIU","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(28,54,135,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"CIU","legendgroup":"CIU","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000013,"base":0,"x":[2],"y":[0.75993205642772477],"text":"siglas: CIU<br />diferencia:  0.75993206<br />siglas: CIU","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(28,54,135,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"CIU","legendgroup":"CIU","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[3],"y":[1.282661712277033],"text":"siglas: CS<br />diferencia:  1.28266171<br />siglas: CS","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(250,79,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"CS","legendgroup":"CS","showlegend":true,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[3],"y":[1.7117598866750257],"text":"siglas: CS<br />diferencia:  1.71175989<br />siglas: CS","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(250,79,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"CS","legendgroup":"CS","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[3],"y":[0.18251800278286368],"text":"siglas: CS<br />diferencia:  0.18251800<br />siglas: CS","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(250,79,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"CS","legendgroup":"CS","showlegend":false,"xaxis":"x2","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[3],"y":[4.2553370362828122],"text":"siglas: CS<br />diferencia:  4.25533704<br />siglas: CS","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(250,79,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"CS","legendgroup":"CS","showlegend":false,"xaxis":"x3","yaxis":"y6","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[4],"y":[0.58149344433349426],"text":"siglas: EAJPNV<br />diferencia:  0.58149344<br />siglas: EAJPNV","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(6,124,41,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"EAJPNV","legendgroup":"EAJPNV","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[4],"y":[0.13069314061752735],"text":"siglas: EAJPNV<br />diferencia:  0.13069314<br />siglas: EAJPNV","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(6,124,41,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"EAJPNV","legendgroup":"EAJPNV","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[4],"y":[0.21625178357235741],"text":"siglas: EAJPNV<br />diferencia:  0.21625178<br />siglas: EAJPNV","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(6,124,41,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"EAJPNV","legendgroup":"EAJPNV","showlegend":false,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[4],"y":[0.083104144224334098],"text":"siglas: EAJPNV<br />diferencia:  0.08310414<br />siglas: EAJPNV","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(6,124,41,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"EAJPNV","legendgroup":"EAJPNV","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[4],"y":[0.047675043225356095],"text":"siglas: EAJPNV<br />diferencia:  0.04767504<br />siglas: EAJPNV","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(6,124,41,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"EAJPNV","legendgroup":"EAJPNV","showlegend":false,"xaxis":"x2","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[4],"y":[0.39141600825760547],"text":"siglas: EAJPNV<br />diferencia:  0.39141601<br />siglas: EAJPNV","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(6,124,41,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"EAJPNV","legendgroup":"EAJPNV","showlegend":false,"xaxis":"x3","yaxis":"y6","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[5],"y":[0.1882033366597593],"text":"siglas: EHBILDU<br />diferencia:  0.18820334<br />siglas: EHBILDU","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(8,204,180,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"EHBILDU","legendgroup":"EHBILDU","showlegend":true,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[5],"y":[0.10342850622361166],"text":"siglas: EHBILDU<br />diferencia:  0.10342851<br />siglas: EHBILDU","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(8,204,180,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"EHBILDU","legendgroup":"EHBILDU","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[5],"y":[0.095077590965123915],"text":"siglas: EHBILDU<br />diferencia:  0.09507759<br />siglas: EHBILDU","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(8,204,180,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"EHBILDU","legendgroup":"EHBILDU","showlegend":false,"xaxis":"x2","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[5],"y":[0.13910729686469736],"text":"siglas: EHBILDU<br />diferencia:  0.13910730<br />siglas: EHBILDU","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(8,204,180,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"EHBILDU","legendgroup":"EHBILDU","showlegend":false,"xaxis":"x3","yaxis":"y6","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[6],"y":[1.1783475170206112],"text":"siglas: ERC<br />diferencia:  1.17834752<br />siglas: ERC","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,191,65,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"ERC","legendgroup":"ERC","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[6],"y":[0.059675856421628204],"text":"siglas: ERC<br />diferencia:  0.05967586<br />siglas: ERC","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,191,65,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"ERC","legendgroup":"ERC","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[6],"y":[0.046168260145288631],"text":"siglas: ERC<br />diferencia:  0.04616826<br />siglas: ERC","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,191,65,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"ERC","legendgroup":"ERC","showlegend":false,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[6],"y":[0.059207726467680466],"text":"siglas: ERC<br />diferencia:  0.05920773<br />siglas: ERC","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,191,65,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"ERC","legendgroup":"ERC","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[6],"y":[0.14896622424941741],"text":"siglas: ERC<br />diferencia:  0.14896622<br />siglas: ERC","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,191,65,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"ERC","legendgroup":"ERC","showlegend":false,"xaxis":"x2","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[6],"y":[1.1495995008856901],"text":"siglas: ERC<br />diferencia:  1.14959950<br />siglas: ERC","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,191,65,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"ERC","legendgroup":"ERC","showlegend":false,"xaxis":"x3","yaxis":"y6","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[7],"y":[1.6205399916805339],"text":"siglas: MÉSCOMPROM<br />diferencia:  1.62053999<br />siglas: MÉSCOMPROM","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(214,80,42,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"MÉSCOMPROM","legendgroup":"MÉSCOMPROM","showlegend":true,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[7],"y":[0.52844545919656971],"text":"siglas: MÉSCOMPROM<br />diferencia:  0.52844546<br />siglas: MÉSCOMPROM","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(214,80,42,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"MÉSCOMPROM","legendgroup":"MÉSCOMPROM","showlegend":false,"xaxis":"x2","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[7],"y":[0.033450613238570681],"text":"siglas: MÉSCOMPROM<br />diferencia:  0.03345061<br />siglas: MÉSCOMPROM","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(214,80,42,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"MÉSCOMPROM","legendgroup":"MÉSCOMPROM","showlegend":false,"xaxis":"x3","yaxis":"y6","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999947,"base":0,"x":[8],"y":[2.5712942819402],"text":"siglas: MPAÍS<br />diferencia:  2.57129428<br />siglas: MPAÍS","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(22,124,108,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"MPAÍS","legendgroup":"MPAÍS","showlegend":true,"xaxis":"x3","yaxis":"y6","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999858,"base":0,"x":[9],"y":[7.082785211441915],"text":"siglas: OTROS<br />diferencia:  7.08278521<br />siglas: OTROS","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"OTROS","legendgroup":"OTROS","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999858,"base":0,"x":[9],"y":[8.6938734804434183],"text":"siglas: OTROS<br />diferencia:  8.69387348<br />siglas: OTROS","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"OTROS","legendgroup":"OTROS","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999858,"base":0,"x":[9],"y":[4.8529613486326664],"text":"siglas: OTROS<br />diferencia:  4.85296135<br />siglas: OTROS","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"OTROS","legendgroup":"OTROS","showlegend":false,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999858,"base":0,"x":[9],"y":[2.3557923092633031],"text":"siglas: OTROS<br />diferencia:  2.35579231<br />siglas: OTROS","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"OTROS","legendgroup":"OTROS","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999858,"base":0,"x":[9],"y":[4.6439023626333142],"text":"siglas: OTROS<br />diferencia:  4.64390236<br />siglas: OTROS","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"OTROS","legendgroup":"OTROS","showlegend":false,"xaxis":"x2","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999858,"base":0,"x":[9],"y":[6.3773743170557662],"text":"siglas: OTROS<br />diferencia:  6.37737432<br />siglas: OTROS","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,190,190,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"OTROS","legendgroup":"OTROS","showlegend":false,"xaxis":"x3","yaxis":"y6","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999858,"base":0,"x":[10],"y":[1.809300008507174],"text":"siglas: PODEMOS<br />diferencia:  1.80930001<br />siglas: PODEMOS","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(147,107,244,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"PODEMOS","legendgroup":"PODEMOS","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999858,"base":0,"x":[10],"y":[2.4212870510246121],"text":"siglas: PODEMOS<br />diferencia:  2.42128705<br />siglas: PODEMOS","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(147,107,244,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"PODEMOS","legendgroup":"PODEMOS","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999858,"base":0,"x":[10],"y":[1.2806806790666094],"text":"siglas: PODEMOS<br />diferencia:  1.28068068<br />siglas: PODEMOS","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(147,107,244,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"PODEMOS","legendgroup":"PODEMOS","showlegend":false,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999858,"base":0,"x":[10],"y":[3.197959380932371],"text":"siglas: PODEMOS<br />diferencia:  3.19795938<br />siglas: PODEMOS","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(147,107,244,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"PODEMOS","legendgroup":"PODEMOS","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999858,"base":0,"x":[10],"y":[1.3354466542918821],"text":"siglas: PODEMOS<br />diferencia:  1.33544665<br />siglas: PODEMOS","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(147,107,244,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"PODEMOS","legendgroup":"PODEMOS","showlegend":false,"xaxis":"x2","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999858,"base":0,"x":[10],"y":[0.35600189524599202],"text":"siglas: PODEMOS<br />diferencia:  0.35600190<br />siglas: PODEMOS","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(147,107,244,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"PODEMOS","legendgroup":"PODEMOS","showlegend":false,"xaxis":"x3","yaxis":"y6","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999858,"base":0,"x":[11],"y":[2.1752626008225775],"text":"siglas: PP<br />diferencia:  2.17526260<br />siglas: PP","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,86,163,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"PP","legendgroup":"PP","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999858,"base":0,"x":[11],"y":[2.0541893050652078],"text":"siglas: PP<br />diferencia:  2.05418931<br />siglas: PP","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,86,163,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"PP","legendgroup":"PP","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999858,"base":0,"x":[11],"y":[1.1928043210208976],"text":"siglas: PP<br />diferencia:  1.19280432<br />siglas: PP","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,86,163,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"PP","legendgroup":"PP","showlegend":false,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999858,"base":0,"x":[11],"y":[3.6037806828315517],"text":"siglas: PP<br />diferencia:  3.60378068<br />siglas: PP","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,86,163,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"PP","legendgroup":"PP","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999858,"base":0,"x":[11],"y":[3.6083339501603824],"text":"siglas: PP<br />diferencia:  3.60833395<br />siglas: PP","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,86,163,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"PP","legendgroup":"PP","showlegend":false,"xaxis":"x2","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999858,"base":0,"x":[11],"y":[0.56942871138808826],"text":"siglas: PP<br />diferencia:  0.56942871<br />siglas: PP","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,86,163,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"PP","legendgroup":"PP","showlegend":false,"xaxis":"x3","yaxis":"y6","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999858,"base":0,"x":[12],"y":[4.6931335463291362],"text":"siglas: PSOE<br />diferencia:  4.69313355<br />siglas: PSOE","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(228,4,20,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"PSOE","legendgroup":"PSOE","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999858,"base":0,"x":[12],"y":[10.713563138111041],"text":"siglas: PSOE<br />diferencia: 10.71356314<br />siglas: PSOE","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(228,4,20,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"PSOE","legendgroup":"PSOE","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999858,"base":0,"x":[12],"y":[2.3322897962579532],"text":"siglas: PSOE<br />diferencia:  2.33228980<br />siglas: PSOE","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(228,4,20,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"PSOE","legendgroup":"PSOE","showlegend":false,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999858,"base":0,"x":[12],"y":[1.0434105769531392],"text":"siglas: PSOE<br />diferencia:  1.04341058<br />siglas: PSOE","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(228,4,20,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"PSOE","legendgroup":"PSOE","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999858,"base":0,"x":[12],"y":[1.1663263465455387],"text":"siglas: PSOE<br />diferencia:  1.16632635<br />siglas: PSOE","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(228,4,20,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"PSOE","legendgroup":"PSOE","showlegend":false,"xaxis":"x2","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999858,"base":0,"x":[12],"y":[3.5309937430686205],"text":"siglas: PSOE<br />diferencia:  3.53099374<br />siglas: PSOE","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(228,4,20,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"PSOE","legendgroup":"PSOE","showlegend":false,"xaxis":"x3","yaxis":"y6","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999858,"base":0,"x":[13],"y":[0.52793698701051639],"text":"siglas: VOX<br />diferencia:  0.52793699<br />siglas: VOX","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(90,192,53,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"VOX","legendgroup":"VOX","showlegend":true,"xaxis":"x2","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":0.89999999999999858,"base":0,"x":[13],"y":[4.5582307143686975],"text":"siglas: VOX<br />diferencia:  4.55823071<br />siglas: VOX","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(90,192,53,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"VOX","legendgroup":"VOX","showlegend":false,"xaxis":"x3","yaxis":"y6","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":37.917808219178085,"r":7.3059360730593621,"b":28.493150684931511,"l":31.415525114155255},"paper_bgcolor":"rgba(255,245,238,1)","font":{"color":"rgba(0,0,0,1)","family":"Montserrat","size":14.611872146118724},"xaxis":{"domain":[0,0.3259947814742335],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,13.6],"tickmode":"array","ticktext":["BNG","CIU","CS","EAJPNV","EHBILDU","ERC","MÉSCOMPROM","MPAÍS","OTROS","PODEMOS","PP","PSOE","VOX"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13],"categoryorder":"array","categoryarray":["BNG","CIU","CS","EAJPNV","EHBILDU","ERC","MÉSCOMPROM","MPAÍS","OTROS","PODEMOS","PP","PSOE","VOX"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y4","title":"","hoverformat":".2f"},"annotations":[{"text":"<b> siglas <\/b>","x":0.5,"y":0,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"Montserrat","size":14.611872146118724},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"top","annotationType":"axis","yshift":-7.3059360730593621},{"text":"<b> diferencia <\/b>","x":0,"y":0.5,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"Montserrat","size":14.611872146118724},"xref":"paper","yref":"paper","textangle":-90,"xanchor":"right","yanchor":"center","annotationType":"axis","xshift":-16.0730593607306},{"text":"2008-03-01","x":0.16299739073711675,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"Montserrat","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"2011-11-01","x":0.5,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"Montserrat","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"2015-12-01","x":0.83700260926288328,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"Montserrat","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"2016-06-01","x":0.16299739073711675,"y":0.48515981735159819,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"Montserrat","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"2019-04-01","x":0.5,"y":0.48515981735159819,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"Montserrat","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"2019-11-01","x":0.83700260926288328,"y":0.48515981735159819,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"Montserrat","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"}],"yaxis":{"domain":[0.51484018264840181,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.35413926057209577,7.4369244720140104],"tickmode":"array","ticktext":["0","2","4","6"],"tickvals":[0,2,3.9999999999999996,6],"categoryorder":"array","categoryarray":["0","2","4","6"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"Montserrat","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.3259947814742335,"y0":0.51484018264840181,"y1":1},{"type":"rect","fillcolor":"rgba(235,235,235,1)","line":{"color":"rgba(0,0,0,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":0.3259947814742335,"y0":0,"y1":23.37899543378996,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.34067188519243313,"x1":0.65932811480756681,"y0":0.51484018264840181,"y1":1},{"type":"rect","fillcolor":"rgba(235,235,235,1)","line":{"color":"rgba(0,0,0,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.34067188519243313,"x1":0.65932811480756681,"y0":0,"y1":23.37899543378996,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.67400521852576645,"x1":1,"y0":0.51484018264840181,"y1":1},{"type":"rect","fillcolor":"rgba(235,235,235,1)","line":{"color":"rgba(0,0,0,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.67400521852576645,"x1":1,"y0":0,"y1":23.37899543378996,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.3259947814742335,"y0":0,"y1":0.48515981735159819},{"type":"rect","fillcolor":"rgba(235,235,235,1)","line":{"color":"rgba(0,0,0,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":0.3259947814742335,"y0":0,"y1":23.37899543378996,"yanchor":0.48515981735159819,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.34067188519243313,"x1":0.65932811480756681,"y0":0,"y1":0.48515981735159819},{"type":"rect","fillcolor":"rgba(235,235,235,1)","line":{"color":"rgba(0,0,0,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.34067188519243313,"x1":0.65932811480756681,"y0":0,"y1":23.37899543378996,"yanchor":0.48515981735159819,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.67400521852576645,"x1":1,"y0":0,"y1":0.48515981735159819},{"type":"rect","fillcolor":"rgba(235,235,235,1)","line":{"color":"rgba(0,0,0,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.67400521852576645,"x1":1,"y0":0,"y1":23.37899543378996,"yanchor":0.48515981735159819,"ysizemode":"pixel"}],"xaxis2":{"type":"linear","autorange":false,"range":[0.40000000000000002,13.6],"tickmode":"array","ticktext":["BNG","CIU","CS","EAJPNV","EHBILDU","ERC","MÉSCOMPROM","MPAÍS","OTROS","PODEMOS","PP","PSOE","VOX"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13],"categoryorder":"array","categoryarray":["BNG","CIU","CS","EAJPNV","EHBILDU","ERC","MÉSCOMPROM","MPAÍS","OTROS","PODEMOS","PP","PSOE","VOX"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.34067188519243313,0.65932811480756681],"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y5","title":"","hoverformat":".2f"},"yaxis2":{"type":"linear","autorange":false,"range":[-0.53567815690555209,11.249241295016594],"tickmode":"array","ticktext":["0","3","6","9"],"tickvals":[0,3,6,9],"categoryorder":"array","categoryarray":["0","3","6","9"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"Montserrat","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.51484018264840181,1],"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x2","title":"","hoverformat":".2f"},"xaxis3":{"type":"linear","autorange":false,"range":[0.40000000000000002,13.6],"tickmode":"array","ticktext":["BNG","CIU","CS","EAJPNV","EHBILDU","ERC","MÉSCOMPROM","MPAÍS","OTROS","PODEMOS","PP","PSOE","VOX"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13],"categoryorder":"array","categoryarray":["BNG","CIU","CS","EAJPNV","EHBILDU","ERC","MÉSCOMPROM","MPAÍS","OTROS","PODEMOS","PP","PSOE","VOX"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.67400521852576645,1],"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y6","title":"","hoverformat":".2f"},"yaxis3":{"type":"linear","autorange":false,"range":[-0.24264806743163334,5.0956094160643],"tickmode":"array","ticktext":["0","1","2","3","4","5"],"tickvals":[2.7755575615628914e-17,1,1.9999999999999998,3,4,5],"categoryorder":"array","categoryarray":["0","1","2","3","4","5"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"Montserrat","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.51484018264840181,1],"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x3","title":"","hoverformat":".2f"},"yaxis4":{"type":"linear","autorange":false,"range":[-0.18018903414157761,3.7839697169731292],"tickmode":"array","ticktext":["0","1","2","3"],"tickvals":[0,0.99999999999999989,2,3],"categoryorder":"array","categoryarray":["0","1","2","3"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"Montserrat","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.48515981735159819],"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis5":{"type":"linear","autorange":false,"range":[-0.23219511813166571,4.8760974807649795],"tickmode":"array","ticktext":["0","1","2","3","4"],"tickvals":[0,1,2,3,3.9999999999999996],"categoryorder":"array","categoryarray":["0","1","2","3","4"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"Montserrat","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.48515981735159819],"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x2","title":"","hoverformat":".2f"},"yaxis6":{"type":"linear","autorange":false,"range":[-0.31886871585278831,6.6962430329085549],"tickmode":"array","ticktext":["0","2","4","6"],"tickvals":[0,2,4,6],"categoryorder":"array","categoryarray":["0","2","4","6"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"Montserrat","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.48515981735159819],"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x3","title":"","hoverformat":".2f"},"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"Montserrat","size":11.68949771689498},"title":{"text":"siglas","font":{"color":"rgba(0,0,0,1)","family":"Montserrat","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"1dbc38ea7e23":{"x":{},"y":{},"fill":{},"type":"bar"}},"cur_data":"1dbc38ea7e23","visdat":{"1dbc38ea7e23":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="ejercicio-9" class="level2">
<h2 class="anchored" data-anchor-id="ejercicio-9">EJERCICIO 9</h2>
<p>¿En qué elección se equivocaron más las encuestas?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>error_elec <span class="ot">&lt;-</span> </span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  error_casa_encuestadora <span class="sc">|&gt;</span> </span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">media_error =</span> <span class="fu">mean</span>(diferencia), <span class="at">.by =</span> <span class="fu">c</span>(fecha, pollster)) <span class="sc">|&gt;</span> </span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(media_error<span class="sc">==</span><span class="fu">max</span>(media_error))</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> </span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(error_casa_encuestadora <span class="sc">|&gt;</span> </span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>         <span class="fu">summarise</span>(<span class="at">media_error =</span> <span class="fu">mean</span>(diferencia), <span class="at">.by =</span> <span class="fu">c</span>(fecha, pollster)) <span class="sc">|&gt;</span> </span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>         <span class="fu">slice_max</span>(media_error, <span class="at">n=</span><span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> fecha), <span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">breaks =</span> <span class="st">"2.5 year"</span>) <span class="sc">+</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Error encuestas"</span>, </span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"aparición"</span>) </span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>plotly<span class="sc">::</span><span class="fu">ggplotly</span>(plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-41453f899a7d24f4ac7e" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-41453f899a7d24f4ac7e">{"x":{"data":[{"orientation":"v","width":[164.70000000000073,164.69999999999709,164.69999999999709,164.69999999999709,164.69999999999709],"base":[0,0,0,0,0],"x":[13939,16770,16953,17987,18201],"y":[3,1,3,4,9],"text":["count: 3<br />fecha: 13939","count: 1<br />fecha: 16770","count: 3<br />fecha: 16953","count: 4<br />fecha: 17987","count: 9<br />fecha: 18201"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(173,216,230,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":59.437110834371111,"r":7.3059360730593621,"b":40.182648401826491,"l":43.105022831050235},"paper_bgcolor":"rgba(255,245,238,1)","font":{"color":"rgba(0,0,0,1)","family":"Montserrat","size":14.611872146118724},"title":{"text":"<b> Error encuestas <\/b>","font":{"color":"rgba(0,0,0,1)","family":"Montserrat","size":33.208800332088011},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[13635.315000000001,18504.684999999998],"tickmode":"array","ticktext":["2009-01-01","2011-01-01","2013-01-01","2015-01-01","2017-01-01","2019-01-01"],"tickvals":[14245,14975,15706,16436,17167,17897],"categoryorder":"array","categoryarray":["2009-01-01","2011-01-01","2013-01-01","2015-01-01","2017-01-01","2019-01-01"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"Montserrat","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"<b> fecha <\/b>","font":{"color":"rgba(0,0,0,1)","family":"Montserrat","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.45000000000000001,9.4499999999999993],"tickmode":"array","ticktext":["0.0","2.5","5.0","7.5"],"tickvals":[0,2.5000000000000004,5,7.5],"categoryorder":"array","categoryarray":["0.0","2.5","5.0","7.5"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"Montserrat","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"<b> aparición <\/b>","font":{"color":"rgba(0,0,0,1)","family":"Montserrat","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"Montserrat","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"1dbc535d2b70":{"x":{},"type":"bar"}},"cur_data":"1dbc535d2b70","visdat":{"1dbc535d2b70":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Las encuesta que más se equivocó fue la realizada por 40DB en las elecciones del 2019-11-01 con una media de error del 2.6546548</p>
</section>
<section id="ejercicio-10" class="level2">
<h2 class="anchored" data-anchor-id="ejercicio-10">EJERCICIO 10</h2>
<p>¿Cómo se equivocaron las encuestas en partidos de ámbito nacional (PSOE, PP, VOX, CS, MP, UP - IU)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>error_casa_encuestadora <span class="sc">|&gt;</span> </span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(siglas, <span class="st">"PSOE|PP|VOX|CS|MP|UP"</span>), <span class="fu">year</span>(fecha) <span class="sc">==</span> <span class="dv">2008</span>) <span class="sc">|&gt;</span> </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> pollster, <span class="at">fill =</span> siglas, <span class="at">y =</span> diferencia), </span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">position =</span> <span class="st">"dodge2"</span>) <span class="sc">+</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#0056a3"</span>, <span class="st">"#e40414"</span>)) <span class="sc">+</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Casa encuestadora"</span>,</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Error de las encuestas en partidos nacionales 2008"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>error_casa_encuestadora <span class="sc">|&gt;</span> </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(siglas, <span class="st">"PSOE|PP|VOX|CS|MP|UP"</span>), <span class="fu">year</span>(fecha) <span class="sc">==</span> <span class="dv">2011</span>) <span class="sc">|&gt;</span> </span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> pollster, <span class="at">fill =</span> siglas, <span class="at">y =</span> diferencia), </span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">position =</span> <span class="st">"dodge2"</span>)<span class="sc">+</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#0056a3"</span>, <span class="st">"#e40414"</span>)) <span class="sc">+</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Casa encuestadora"</span>,</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Error de las encuestas en partidos nacionales 2011"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-33-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>error_casa_encuestadora <span class="sc">|&gt;</span> </span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(siglas, <span class="st">"PSOE|PP|VOX|CS|MP|UP"</span>), <span class="fu">year</span>(fecha) <span class="sc">==</span> <span class="dv">2015</span>) <span class="sc">|&gt;</span> </span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> pollster, <span class="at">fill =</span> siglas, <span class="at">y =</span> diferencia), </span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">position =</span> <span class="st">"dodge2"</span>)<span class="sc">+</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#fa4f00"</span>, <span class="st">"#d6502a"</span>,</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"#0056a3"</span>, <span class="st">"#e40414"</span>)) <span class="sc">+</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Casa encuestadora"</span>,</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Error de las encuestas en partidos nacionales 2015"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-33-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>error_casa_encuestadora <span class="sc">|&gt;</span> </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(siglas, <span class="st">"PSOE|PP|VOX|CS|MP|UP"</span>), <span class="fu">year</span>(fecha) <span class="sc">==</span> <span class="dv">2016</span>) <span class="sc">|&gt;</span> </span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> pollster, <span class="at">fill =</span> siglas, <span class="at">y =</span> diferencia), </span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">position =</span> <span class="st">"dodge2"</span>)<span class="sc">+</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#fa4f00"</span>, <span class="st">"#0056a3"</span>, <span class="st">"#e40414"</span>)) <span class="sc">+</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Casa encuestadora"</span>,</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Error de las encuestas en partidos nacionales 2016"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-33-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>error_casa_encuestadora <span class="sc">|&gt;</span> </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(siglas, <span class="st">"PSOE|PP|VOX|CS|MP|UP"</span>), </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">year</span>(fecha) <span class="sc">==</span> <span class="dv">2019</span>, <span class="fu">month</span>(fecha) <span class="sc">==</span> <span class="dv">04</span>) <span class="sc">|&gt;</span> </span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> pollster, <span class="at">fill =</span> siglas, <span class="at">y =</span> diferencia), </span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">position =</span> <span class="st">"dodge2"</span>)<span class="sc">+</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#fa4f00"</span>, <span class="st">"#d6502a"</span>,</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"#0056a3"</span>, <span class="st">"#e40414"</span>,<span class="st">"#5ac035"</span>)) <span class="sc">+</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Casa encuestadora"</span>,</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Error de las encuestas en partidos nacionales 2019-04"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-33-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>error_casa_encuestadora <span class="sc">|&gt;</span> </span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(siglas, <span class="st">"PSOE|PP|VOX|CS|MP|UP"</span>), </span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">year</span>(fecha) <span class="sc">==</span> <span class="dv">2019</span>, <span class="fu">month</span>(fecha) <span class="sc">==</span> <span class="dv">11</span>) <span class="sc">|&gt;</span> </span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> pollster, <span class="at">fill =</span> siglas, <span class="at">y =</span> diferencia), </span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">position =</span> <span class="st">"dodge2"</span>)<span class="sc">+</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#fa4f00"</span>, <span class="st">"#d6502a"</span>,<span class="st">"#167c6c"</span>,</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"#0056a3"</span>, <span class="st">"#e40414"</span>,<span class="st">"#5ac035"</span>)) <span class="sc">+</span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Casa encuestadora"</span>,</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Error de las encuestas en partidos nacionales 2019-11"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-33-6.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="ejercicio-11" class="level2">
<h2 class="anchored" data-anchor-id="ejercicio-11">EJERCICIO 11</h2>
<p>¿Qué casas encuestadores acertaron más y cuales se desviaron más de los resultados?</p>
<p>Viendo la gráfica, las encuestas que más aciertan son aquellos cuyos valores sean más cercanos al 0 y el color de su barra sea blanco, mientras que los que más fallan son aquellos que se alejan del 0 y están en los extremos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>data_comparacion_graf <span class="ot">&lt;-</span> </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  error_casa_encuestadora <span class="sc">|&gt;</span> </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(fecha)<span class="sc">==</span><span class="dv">2008</span>) <span class="sc">|&gt;</span> </span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pollster) <span class="sc">|&gt;</span> </span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">media_dif=</span><span class="fu">mean</span>(diferencia)) <span class="sc">|&gt;</span> </span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(pollster, <span class="at">.keep_all=</span><span class="cn">TRUE</span>)</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>gr2008 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_comparacion_graf, <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_reorder</span>(pollster,media_dif), <span class="at">x =</span> media_dif)) <span class="sc">+</span> </span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> media_dif)) <span class="sc">+</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>,</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">midpoint =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(data_comparacion_graf<span class="sc">$</span>media_dif)) <span class="sc">+</span></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Casa encuestadora"</span>,</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Error en la estimacion"</span>,</span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Error de estimacion"</span>,</span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Error de estimacion en 2008"</span>)</span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a>gr2008</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>data_comparacion_graf_2011<span class="ot">&lt;-</span> error_casa_encuestadora <span class="sc">|&gt;</span> </span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(fecha)<span class="sc">==</span><span class="dv">2011</span>) <span class="sc">|&gt;</span> </span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pollster) <span class="sc">|&gt;</span> </span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">media_dif=</span><span class="fu">mean</span>(diferencia)) <span class="sc">|&gt;</span> </span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(pollster, <span class="at">.keep_all=</span><span class="cn">TRUE</span>)</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>gr2011 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_comparacion_graf_2011, </span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_reorder</span>(pollster,media_dif), <span class="at">x =</span> media_dif )) <span class="sc">+</span> </span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> media_dif)) <span class="sc">+</span></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>,</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">midpoint =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span><span class="fu">mean</span>(data_comparacion_graf_2011<span class="sc">$</span>media_dif)) <span class="sc">+</span></span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Casa encuestadora"</span>,</span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Error en la estimacion"</span>,</span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Error de estimacion"</span>,</span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Error de estimacion en 2011"</span>)</span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a>gr2011</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>data_comparacion_graf_2015<span class="ot">&lt;-</span> error_casa_encuestadora <span class="sc">|&gt;</span> </span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(fecha)<span class="sc">==</span><span class="dv">2015</span>) <span class="sc">|&gt;</span> </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pollster) <span class="sc">|&gt;</span> </span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">media_dif=</span><span class="fu">mean</span>(diferencia)) <span class="sc">|&gt;</span> </span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(pollster, <span class="at">.keep_all=</span><span class="cn">TRUE</span>)</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>gr2015 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_comparacion_graf_2015, </span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_reorder</span>(pollster,media_dif), <span class="at">x =</span> media_dif)) <span class="sc">+</span> </span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> media_dif)) <span class="sc">+</span></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>,</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">midpoint =</span> <span class="sc">-</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span><span class="fu">mean</span>(data_comparacion_graf_2015<span class="sc">$</span>media_dif)) <span class="sc">+</span></span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Casa encuestadora"</span>,</span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Error en la estimacion"</span>,</span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Error de estimacion"</span>,</span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Error de estimacion en 2015"</span>)</span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a>gr2015</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>data_comparacion_graf_2016<span class="ot">&lt;-</span> error_casa_encuestadora <span class="sc">|&gt;</span> </span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(fecha)<span class="sc">==</span><span class="dv">2016</span>) <span class="sc">|&gt;</span> </span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pollster) <span class="sc">|&gt;</span> </span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">media_dif=</span><span class="fu">mean</span>(diferencia)) <span class="sc">|&gt;</span> </span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(pollster, <span class="at">.keep_all=</span><span class="cn">TRUE</span>)</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>gr2016 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_comparacion_graf_2016, <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_reorder</span>(pollster, media_dif) , <span class="at">x =</span> media_dif)) <span class="sc">+</span> </span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> media_dif)) <span class="sc">+</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>,</span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">midpoint =</span> <span class="fl">0.65</span>) <span class="sc">+</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span><span class="fu">mean</span>(data_comparacion_graf_2016<span class="sc">$</span>media_dif)) <span class="sc">+</span></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Casa encuestadora"</span>,</span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Error en la estimacion"</span>,</span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Error de estimacion"</span>,</span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Error de estimacion en 2016"</span>)</span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a>gr2016</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>data_comparacion_graf_2019<span class="ot">&lt;-</span> error_casa_encuestadora <span class="sc">|&gt;</span> </span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(fecha)<span class="sc">==</span><span class="dv">2019</span>, <span class="fu">month</span>(fecha)<span class="sc">==</span><span class="dv">04</span>) <span class="sc">|&gt;</span> </span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pollster) <span class="sc">|&gt;</span> </span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">media_dif=</span><span class="fu">mean</span>(diferencia)) <span class="sc">|&gt;</span> </span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(pollster, <span class="at">.keep_all=</span><span class="cn">TRUE</span>)</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>gr2019 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_comparacion_graf_2019, <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_reorder</span>(pollster, media_dif), <span class="at">x =</span> media_dif)) <span class="sc">+</span> </span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> media_dif)) <span class="sc">+</span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>,</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">midpoint =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span><span class="fu">mean</span>(data_comparacion_graf_2019<span class="sc">$</span>media_dif)) <span class="sc">+</span></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Casa encuestadora"</span>,</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Error en la estimacion"</span>,</span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Error de estimacion"</span>,</span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Error de estimacion en 2019"</span>)</span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>gr2019</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>data_comparacion_graf_2019_11 <span class="ot">&lt;-</span> error_casa_encuestadora <span class="sc">|&gt;</span> </span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(fecha)<span class="sc">==</span><span class="dv">2019</span>, <span class="fu">month</span>(fecha)<span class="sc">==</span><span class="dv">11</span>) <span class="sc">|&gt;</span> </span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pollster) <span class="sc">|&gt;</span> </span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">media_dif=</span><span class="fu">mean</span>(diferencia)) <span class="sc">|&gt;</span> </span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(pollster, <span class="at">.keep_all=</span><span class="cn">TRUE</span>)</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>gr2019_11 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_comparacion_graf_2019_11, </span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_reorder</span>(pollster, media_dif), <span class="at">x =</span> media_dif)) <span class="sc">+</span> </span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> media_dif)) <span class="sc">+</span></span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>,</span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">midpoint =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span><span class="fu">mean</span>(data_comparacion_graf_2019_11<span class="sc">$</span>media_dif)) <span class="sc">+</span></span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Casa encuestadora"</span>,</span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Error en la estimacion"</span>,</span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Error de estimacion"</span>,</span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Error de estimacion en 2019"</span>)</span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a>gr2019_11</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustar el fondo de cada gráfico</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>gr2008 <span class="ot">&lt;-</span> gr2008 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>), <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>))</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>gr2011 <span class="ot">&lt;-</span> gr2011 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>), <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>))</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>gr2015 <span class="ot">&lt;-</span> gr2015 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>), <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>))</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>gr2016 <span class="ot">&lt;-</span> gr2016 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>), <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>))</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>gr2019 <span class="ot">&lt;-</span> gr2019 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>), <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>))</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>gr2019 <span class="ot">&lt;-</span> gr2019_11 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>), <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>))</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"gr2008.png"</span>, gr2008, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">bg =</span> <span class="st">"white"</span>)</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"gr2011.png"</span>, gr2011, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">bg =</span> <span class="st">"white"</span>)</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"gr2015.png"</span>, gr2015, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">bg =</span> <span class="st">"white"</span>)</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"gr2016.png"</span>, gr2016, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">bg =</span> <span class="st">"white"</span>)</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"gr2019.png"</span>, gr2019, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">bg =</span> <span class="st">"white"</span>)</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"gr2019_11.png"</span>, gr2019_11, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">bg =</span> <span class="st">"white"</span>)</span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magick)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'magick' was built under R version 4.3.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Linking to ImageMagick 6.9.12.98
Enabled features: cairo, freetype, fftw, ghostscript, heic, lcms, pango, raw, rsvg, webp
Disabled features: fontconfig, x11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>img_list <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"gr2008.png"</span>, <span class="st">"gr2011.png"</span>, </span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">"gr2015.png"</span>, <span class="st">"gr2016.png"</span>, <span class="st">"gr2019.png"</span>, <span class="st">"gr2019_11.png"</span>)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>gif <span class="ot">&lt;-</span> <span class="fu">image_read</span>(img_list) <span class="sc">|&gt;</span> </span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">image_animate</span>(<span class="at">fps =</span> <span class="fl">0.25</span>)</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>gif</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-40-1.gif" class="img-fluid"></p>
</div>
</div>
</section>
<section id="nuestros-resultados" class="level2">
<h2 class="anchored" data-anchor-id="nuestros-resultados">3. NUESTROS RESULTADOS</h2>
</section>
<section id="ejercicio-12" class="level2">
<h2 class="anchored" data-anchor-id="ejercicio-12">EJERCICIO 12</h2>
<p>¿Cómo variaron los resultados electorales en municipios con una fuerte presencia de un determinado partido en las elecciones de 2008?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>municipio_mayor_dif_2008 <span class="ot">&lt;-</span> codigo_municipio <span class="sc">|&gt;</span> </span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(fecha)<span class="sc">==</span><span class="dv">2008</span>) <span class="sc">|&gt;</span> </span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(municipio) <span class="sc">|&gt;</span> </span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(municipio)</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>datos_mayor_dif_años <span class="ot">&lt;-</span> datos_limpios <span class="sc">|&gt;</span> </span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cod_mun, <span class="at">by=</span><span class="st">"cod_mun"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(municipio, <span class="at">.before =</span> cod_mun) <span class="sc">|&gt;</span> </span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(municipio <span class="sc">%in%</span> municipio_mayor_dif_2008) <span class="sc">|&gt;</span> </span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fecha, municipio) <span class="sc">|&gt;</span> </span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ganador=</span> <span class="fu">n_votado</span>(siglas, votos),</span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">segundo =</span> <span class="fu">n_votado</span>(siglas, votos, <span class="at">n =</span> <span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(fecha, municipio, <span class="at">.keep_all=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(fecha,municipio, ganador, segundo)</span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a>datos_mayor_dif_años <span class="sc">|&gt;</span> </span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(municipio<span class="sc">==</span><span class="st">"Cañada Rosal"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  fecha      municipio    ganador segundo
  &lt;date&gt;     &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;  
1 2008-03-01 Cañada Rosal PSOE    PP     
2 2011-11-01 Cañada Rosal PSOE    PP     
3 2015-12-01 Cañada Rosal PSOE    PODEMOS
4 2016-06-01 Cañada Rosal PSOE    PODEMOS
5 2019-04-01 Cañada Rosal PSOE    PODEMOS
6 2019-11-01 Cañada Rosal PSOE    PODEMOS</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>datos_mayor_dif_años <span class="sc">|&gt;</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(municipio<span class="sc">==</span><span class="st">"Luisiana, La"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  fecha      municipio    ganador segundo
  &lt;date&gt;     &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;  
1 2008-03-01 Luisiana, La PSOE    PP     
2 2011-11-01 Luisiana, La PSOE    PP     
3 2015-12-01 Luisiana, La PSOE    PODEMOS
4 2016-06-01 Luisiana, La PSOE    PODEMOS
5 2019-04-01 Luisiana, La PSOE    CS     
6 2019-11-01 Luisiana, La PSOE    VOX    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>datos_mayor_dif_años <span class="sc">|&gt;</span> </span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(municipio<span class="sc">==</span><span class="st">"Aznalcóllar"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  fecha      municipio   ganador segundo
  &lt;date&gt;     &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;  
1 2008-03-01 Aznalcóllar PSOE    PP     
2 2011-11-01 Aznalcóllar PSOE    PP     
3 2015-12-01 Aznalcóllar PSOE    PODEMOS
4 2016-06-01 Aznalcóllar PSOE    PODEMOS
5 2019-04-01 Aznalcóllar PSOE    PODEMOS
6 2019-11-01 Aznalcóllar PSOE    PODEMOS</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>datos_mayor_dif_años <span class="sc">|&gt;</span> </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(municipio<span class="sc">==</span> <span class="st">"Brenes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  fecha      municipio ganador segundo
  &lt;date&gt;     &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;  
1 2008-03-01 Brenes    PSOE    PP     
2 2011-11-01 Brenes    PSOE    PP     
3 2015-12-01 Brenes    PSOE    PODEMOS
4 2016-06-01 Brenes    PSOE    PODEMOS
5 2019-04-01 Brenes    PSOE    PODEMOS
6 2019-11-01 Brenes    PSOE    PODEMOS</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>datos_mayor_dif_años <span class="sc">|&gt;</span> </span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(municipio<span class="sc">==</span> <span class="st">"Alosno"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  fecha      municipio ganador segundo
  &lt;date&gt;     &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;  
1 2008-03-01 Alosno    PSOE    PP     
2 2011-11-01 Alosno    PSOE    PP     
3 2015-12-01 Alosno    PSOE    PODEMOS
4 2016-06-01 Alosno    PSOE    PP     
5 2019-04-01 Alosno    PSOE    PODEMOS
6 2019-11-01 Alosno    PSOE    PODEMOS</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>datos_mayor_dif_años <span class="sc">|&gt;</span> </span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(municipio<span class="sc">==</span><span class="st">"Markina-Xemein"</span>) <span class="co">#CAMBIO</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  fecha      municipio      ganador segundo
  &lt;date&gt;     &lt;chr&gt;          &lt;chr&gt;   &lt;chr&gt;  
1 2008-03-01 Markina-Xemein EAJPNV  EHBILDU
2 2011-11-01 Markina-Xemein OTROS   EAJPNV 
3 2015-12-01 Markina-Xemein EAJPNV  EHBILDU
4 2016-06-01 Markina-Xemein EAJPNV  EHBILDU
5 2019-04-01 Markina-Xemein EAJPNV  EHBILDU
6 2019-11-01 Markina-Xemein EAJPNV  EHBILDU</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>datos_mayor_dif_años <span class="sc">|&gt;</span> </span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(municipio<span class="sc">==</span><span class="st">"Paterna de Rivera"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  fecha      municipio         ganador segundo
  &lt;date&gt;     &lt;chr&gt;             &lt;chr&gt;   &lt;chr&gt;  
1 2008-03-01 Paterna de Rivera PSOE    PP     
2 2011-11-01 Paterna de Rivera PSOE    PP     
3 2015-12-01 Paterna de Rivera PSOE    PODEMOS
4 2016-06-01 Paterna de Rivera PSOE    PP     
5 2019-04-01 Paterna de Rivera PSOE    PP     
6 2019-11-01 Paterna de Rivera PSOE    PP     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>datos_mayor_dif_años <span class="sc">|&gt;</span> </span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(municipio<span class="sc">==</span><span class="st">"San Bartolomé de la Torre"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  fecha      municipio                 ganador segundo
  &lt;date&gt;     &lt;chr&gt;                     &lt;chr&gt;   &lt;chr&gt;  
1 2008-03-01 San Bartolomé de la Torre PSOE    PP     
2 2011-11-01 San Bartolomé de la Torre PSOE    PP     
3 2015-12-01 San Bartolomé de la Torre PSOE    PP     
4 2016-06-01 San Bartolomé de la Torre PSOE    PP     
5 2019-04-01 San Bartolomé de la Torre PSOE    CS     
6 2019-11-01 San Bartolomé de la Torre PSOE    VOX    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>datos_mayor_dif_años <span class="sc">|&gt;</span> </span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(municipio<span class="sc">==</span><span class="st">"Montellano"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  fecha      municipio  ganador segundo
  &lt;date&gt;     &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;  
1 2008-03-01 Montellano PSOE    PP     
2 2011-11-01 Montellano PSOE    PP     
3 2015-12-01 Montellano PSOE    PP     
4 2016-06-01 Montellano PSOE    PP     
5 2019-04-01 Montellano PSOE    CS     
6 2019-11-01 Montellano PSOE    VOX    </code></pre>
</div>
</div>
<p><em>Resumiendo</em>: En los municipios con mayor diferencia entre el primero y el segundo, ha ganado en todos el PSOE en todas las elecciones salvo MARKINA-XEMEIN que siempre ganó el PNV menos en las elecciones de 2011 que ganó OTROS.</p>
</section>
<section id="ejercicio-13" class="level2">
<h2 class="anchored" data-anchor-id="ejercicio-13">EJERCICIO 13</h2>
<p>Veamos los porcentajes de abstención en cada fecha de elección, así podemos ver cuánta gente realmente no vota teniendo la opción de ir a votar,¿Cambiará esta cifra en zonas rurales?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>datos_limpios <span class="sc">|&gt;</span> </span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">abstencion =</span> censo <span class="sc">-</span> <span class="fu">sum</span>(votos)<span class="sc">-</span> votos_blancos<span class="sc">-</span>votos_nulos, </span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">.by =</span> <span class="fu">c</span>(cod_mun, fecha)) <span class="sc">|&gt;</span> </span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(cod_mun,fecha, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">porc_abst=</span> abstencion<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span>censo , <span class="at">.by =</span> <span class="fu">c</span>(cod_mun, fecha)) <span class="sc">|&gt;</span> </span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fecha) <span class="sc">|&gt;</span> </span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">media_abste=</span><span class="fu">mean</span>(porc_abst))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  fecha      media_abste
  &lt;date&gt;           &lt;dbl&gt;
1 2008-03-01        21.9
2 2011-11-01        24.9
3 2015-12-01        25.0
4 2016-06-01        26.5
5 2019-04-01        21.8
6 2019-11-01        27.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>datos_abst <span class="ot">&lt;-</span> datos_limpios <span class="sc">|&gt;</span> </span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">abstencion=</span> censo <span class="sc">-</span> <span class="fu">sum</span>(votos)<span class="sc">-</span> votos_blancos<span class="sc">-</span>votos_nulos, </span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">.by =</span> <span class="fu">c</span>(cod_mun, fecha)) <span class="sc">|&gt;</span> </span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(cod_mun,fecha, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">porc_abst=</span> abstencion<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span>censo , <span class="at">.by =</span> <span class="fu">c</span>(cod_mun, fecha)) <span class="sc">|&gt;</span> </span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">ciudad=</span>(censo<span class="sc">&gt;</span><span class="dv">10000</span>), fecha) <span class="sc">|&gt;</span> </span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">media_abste=</span><span class="fu">mean</span>(porc_abst))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'ciudad'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos_abst, <span class="fu">aes</span>(<span class="at">x =</span> fecha, <span class="at">y =</span> media_abste, <span class="at">color =</span> <span class="fu">factor</span>(ciudad))) <span class="sc">+</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Tasa Media de Abstención por Fecha y Tamaño de Ciudad"</span>,</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Año"</span>,</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Media de Tasa de Abstención (%)"</span>,</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Tamaño de Ciudad"</span>) <span class="sc">+</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Menos de 10,000 habitantes"</span>, <span class="st">"Más de 10,000 habitantes"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>La abstención es ligeramente superior en las ciudades que en las zonas rurales.</p>
</section>
<section id="ejercicio-14" class="level2">
<h2 class="anchored" data-anchor-id="ejercicio-14">EJERCICIO 14</h2>
<p>¿Cómo han evolucionado los votos de los partidos nacionalistas?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(votos_partido <span class="sc">|&gt;</span> <span class="fu">filter</span>(siglas <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"EAJPNV"</span>,<span class="st">"ERC"</span>,<span class="st">"BNG"</span>, <span class="st">"MÉSCOMPROM"</span>, <span class="st">"EHBILDU"</span>, <span class="st">"CIU"</span>)), </span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">aes</span>(<span class="at">x =</span> siglas, <span class="at">y =</span> prop_voto)) <span class="sc">+</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> siglas)) <span class="sc">+</span></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#74b4dc"</span>,<span class="st">"#0056a3"</span>, <span class="st">"#067c29"</span>,<span class="st">"#08ccb4"</span>,</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"#ffbf41"</span>, <span class="st">"#d6502a"</span>)) <span class="sc">+</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">"%"</span>)) <span class="sc">+</span></span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_time</span>(fecha) <span class="sc">+</span></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ease_aes</span>(<span class="st">"linear"</span>) <span class="sc">+</span></span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Partido"</span>, </span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Votos"</span>, </span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'Votos por Fecha: {frame_time}'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="entrega-grupal_files/figure-html/unnamed-chunk-44-1.gif" class="img-fluid"></p>
</div>
</div>
<p><strong>Evolución de los partidos nacionalistas</strong>: CIU a lo largo de los años pierde votos igual que el BNG, mientras que ERC gana fuerzas</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>